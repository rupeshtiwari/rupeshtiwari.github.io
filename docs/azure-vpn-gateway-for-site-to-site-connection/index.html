<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Azure VPN Gateway for Site to Site Connection - Rupesh Tiwari - Founder of Fullstack Master</title>
<meta name="description" content="A virtual private network (VPN) is a type of private interconnected network. VPNs use an encrypted tunnel within another network. I will explain what is VPN Gateway and how to deploy in Azure.">


  <meta name="author" content="Rupesh Tiwari">
  
  <meta property="article:author" content="Rupesh Tiwari">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rupesh Tiwari - Founder of Fullstack Master">
<meta property="og:title" content="Azure VPN Gateway for Site to Site Connection">
<meta property="og:url" content="https://www.rupeshtiwari.com/azure-vpn-gateway-for-site-to-site-connection/">


  <meta property="og:description" content="A virtual private network (VPN) is a type of private interconnected network. VPNs use an encrypted tunnel within another network. I will explain what is VPN Gateway and how to deploy in Azure.">



  <meta property="og:image" content="https://i.imgur.com/qxXxmBa.png">



  <meta name="twitter:site" content="@rupeshtiwari_co">
  <meta name="twitter:title" content="Azure VPN Gateway for Site to Site Connection">
  <meta name="twitter:description" content="A virtual private network (VPN) is a type of private interconnected network. VPNs use an encrypted tunnel within another network. I will explain what is VPN Gateway and how to deploy in Azure.">
  <meta name="twitter:url" content="https://www.rupeshtiwari.com/azure-vpn-gateway-for-site-to-site-connection/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://i.imgur.com/qxXxmBa.png">
  

  



  <meta property="article:published_time" content="2021-10-06T00:00:00+00:00">





  
    <meta property="article:publisher" content="https://www.facebook.com/fullstackmaster1">
  

  
    <meta property="fb:app_id" content="421181512329379">
  


<link rel="canonical" href="https://www.rupeshtiwari.com/azure-vpn-gateway-for-site-to-site-connection/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://www.rupeshtiwari.com/"
    
  }
</script>



  <meta name="msvalidate.01" content="8BC08291167B3E15CC4FCC21C5895052">




<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rupesh Tiwari - Founder of Fullstack Master Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Rupesh Tiwari
          <span class="site-subtitle">Sr. Solutions Architect, Author & Trainer</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li><li class="masthead__menu-item">
              <a href="https://youtube.com/fullstackmaster">youtube</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/consulting/">consulting</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.fullstackmaster.net/pro">angular training</a>
            </li><li class="masthead__menu-item">
              <a href="https://fullstackmaster.net/login">sign in</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="https://i.imgur.com/zipiW93.png" alt="Azure VPN Gateway for Site to Site Connection" class="page__hero-image">
  
  
</div>




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://www.rupeshtiwari.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Azure VPN Gateway for Site to Site Connection</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Rupesh Tiwari" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rupesh Tiwari</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I help students and professionals to become Full Stack Software Developer in less than a year!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="rupesh.tiwari.info@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="/posts/" rel="nofollow noopener noreferrer"><i class="fa fa-th-large" aria-hidden="true"></i><span class="label">Blogs</span></a></li>
          
        
          
            <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i><span class="label">Medium</span></a></li>
          
        
          
            <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i><span class="label">Dev.to</span></a></li>
          
        
          
            <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="http://twitter.com/rupeshtiwari_co" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="label">Angular Training</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Azure VPN Gateway for Site to Site Connection">
    <meta itemprop="description" content="  A virtual private network (VPN) is a type of private interconnected network. VPNs use an encrypted tunnel within another network. I will explain what is VPN Gateway and how to deploy in Azure.">
    <meta itemprop="datePublished" content="2021-10-06T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Azure VPN Gateway for Site to Site Connection
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right ">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#azure-vpn-gateways">Azure VPN gateways</a></li><li><a href="#vpn-types">VPN Types</a></li><li><a href="#policy-based-vpns">Policy-based VPNs</a></li><li><a href="#rout-based-vpn">Rout Based VPN</a></li><li><a href="#components-of-vpn-gateway-in-azure">Components of VPN Gateway in Azure</a></li><li><a href="#on-premise-resources">On-Premise resources</a></li><li><a href="#high-availability">High Availability</a><ul><li><a href="#active--standby">Active / Standby</a></li><li><a href="#active-active">Active/ Active</a></li></ul></li><li><a href="#site-to-site-vpn-gateway-deployment">Site to Site VPN Gateway Deployment</a><ul><li><a href="#the-first-step-is-to-create-both-sites-in-azure">The first step is to create both sites in Azure.</a><ul><li><a href="#create-azure-vnet">Create Azure VNet</a></li><li><a href="#create-gatewaysubnet">Create GatewaySubnet</a></li><li><a href="#local-network-gateway-representing-head-quarter-vnet">Local Network Gateway representing Head Quarter VNet</a></li><li><a href="#verify-network-topology">Verify Network Topology</a></li></ul></li><li><a href="#2nd-step-create-a-site-to-site-vpn-gateway-by-using-azure-cli-commands">2nd Step Create a site-to-site VPN gateway by using Azure CLI commands</a></li></ul></li></ul>

            </nav>
          </aside>
        
        <blockquote>
  <p>A virtual private network (VPN) is a type of private interconnected network. VPNs use an encrypted tunnel within another network. I will explain what is VPN Gateway and how to deploy in Azure.</p>
</blockquote>

<h2 id="azure-vpn-gateways">Azure VPN gateways</h2>

<p>Virtual Network Gateway is of 2 types:</p>

<ul>
  <li>VPN Gateway</li>
  <li>ExpressRoute</li>
</ul>

<p><img src="https://i.imgur.com/LXoNdle.png" alt="" class="full" /></p>

<p><code class="language-plaintext highlighter-rouge">ExpressRoute</code> is another gateway type which is most efficient and costly.If your organization uses Office 365. It wants to reduce traffic over the internet and send this traffic over a dedicated connection to Azure. Then ExpressRoute is the best choice. It‚Äôs a service that provides a direct connection from your on-premises datacenter to the Microsoft cloud. One disadvantage is it has no encrypted network communication.</p>

<p><img src="https://i.imgur.com/17uFd0u.png" alt="" class="full" /></p>

<p>I will focus VPN gateway only in this article.</p>

<p>If you want to setup below connections then you need VPN Gateway:</p>

<ul>
  <li>Connect on-premises data centers to Azure virtual networks through a <em>site-to-site</em> connection.</li>
  <li>Connect individual devices to Azure virtual networks through a <em>point-to-site</em> connection.</li>
  <li>Connect Azure virtual networks to other Azure virtual networks through a <em>network-to-network</em> connection.</li>
</ul>

<p><img src="https://i.imgur.com/5ChrRwG.png" alt="" class="full" /></p>

<p class="notice--success">üèÜ <strong>Pro Tip</strong> <br />
<br />
You can deploy only one VPN gateway in each virtual network, but you can use one gateway to connect to multiple locations.</p>

<h2 id="vpn-types">VPN Types</h2>

<p>The main difference of these two types of <code class="language-plaintext highlighter-rouge">VPNs</code> is how traffic to be encrypted is specified.</p>

<p><img src="https://i.imgur.com/9gsqcHn.png" alt="" class="full" /></p>

<ul>
  <li>policy-based</li>
  <li>route-based</li>
</ul>

<h2 id="policy-based-vpns">Policy-based <code class="language-plaintext highlighter-rouge">VPNs</code></h2>

<p>Policy-based VPN gateways specify statically the IP address of packets that should be encrypted through each tunnel.
<img src="https://i.imgur.com/veC2bks.png" alt="" class="full" /></p>

<ul>
  <li>Support for <code class="language-plaintext highlighter-rouge">IKEv1</code> only.</li>
  <li>Used for compatibility with legacy on-premises VPN devices.</li>
  <li>The source and destination of the tunneled networks are declared in the policy and don‚Äôt need to be declared in routing tables.</li>
</ul>

<h2 id="rout-based-vpn">Rout Based VPN</h2>

<p>With route-based gateways, <code class="language-plaintext highlighter-rouge">IPSec</code> tunnels are modeled as a network interface or VTI (virtual tunnel interface). IP routing (static routes or dynamic routing protocols) decide across which one of these tunnel interfaces to send each packet.</p>

<p>Both types of VPN gateways (route-based and policy-based) in Azure use pre-shared key as the only method of authentication. Both types also rely on Internet Key Exchange (IKE) in either version 1 or version 2 and Internet Protocol Security (<code class="language-plaintext highlighter-rouge">IPSec</code>). IKE is used to set up a security association (an agreement of the encryption) between two endpoints. This association is then passed to the <code class="language-plaintext highlighter-rouge">IPSec</code> suite, which encrypts and decrypts data packets encapsulated in the VPN tunnel.</p>

<h2 id="components-of-vpn-gateway-in-azure">Components of VPN Gateway in Azure</h2>

<p>You need below 6 resources to be created and configured in order to setup site-to-site connection with VPN Gateway:
<img src="https://i.imgur.com/40PIjPB.png" alt="" class="full" /></p>

<ul>
  <li><strong>VNet</strong>: Only one VPN Gateway can be deployed in a Single VNet. While creating VNet give enough address space to accommodate future subnets.</li>
  <li><strong>GatewaySubnet</strong>: You need a dedicated subnet for VPN Gateway. You have to call this as <code class="language-plaintext highlighter-rouge">GatewaySubnet</code>. You can not use this subnet for other service. Make sure you give <code class="language-plaintext highlighter-rouge">/27</code> address mask to make sure you have enough IP addresses for future growth. Also remember sometime you want to put 2 VPN Gateways in <code class="language-plaintext highlighter-rouge">Active/Standby</code> or <code class="language-plaintext highlighter-rouge">Active/Active</code> mode within this subnet in order for redundancy.</li>
  <li><strong>Virtual Network Gateway</strong>: Create Virtual Network Gateway of <code class="language-plaintext highlighter-rouge">VPN</code> type. This will route the traffic from on-premise to Azure VNet and vice-versa.</li>
  <li><strong>Public IP address</strong>: Create <code class="language-plaintext highlighter-rouge">Dynamic Public IP Address</code> resource. This address will only change if you delete and recreate the VPN. This IP will be internet facing and your on-premise VPN Device can point to this IP Address.</li>
  <li><strong>Local Network Gateway</strong>: This is created to represent on-premise network‚Äôs configurations. This configuration includes the on-premises VPN device‚Äôs public <code class="language-plaintext highlighter-rouge">IPv4</code> address and the on-premises routable networks. This information is used by the VPN gateway to route packets that are destined for on-premises networks through the <code class="language-plaintext highlighter-rouge">IPSec</code> tunnel.
<img src="https://i.imgur.com/6oqv3B7.png" alt="" class="full" /></li>
  <li><strong>Connection</strong>: Create a <code class="language-plaintext highlighter-rouge">connection</code> resource. Connect VPN Gateway with on-premise VPN Device IPv4 address. Connect VPN Gateway with it‚Äôs Public IP Address.</li>
</ul>

<p><img src="https://i.imgur.com/mV537mU.png" alt="" class="full" /></p>

<h2 id="on-premise-resources">On-Premise resources</h2>

<p>You need Physical VPN Device and a Public-Facing IPv4 address in your data center to connect to Azure resources.</p>

<h2 id="high-availability">High Availability</h2>

<p>Since all traffic has to go from VPN Gateway. You must think of what will happen in case of any issues. We have to work on fault tolerance.</p>

<p>You can use 2 VPN Gateways one in <code class="language-plaintext highlighter-rouge">Active/Standby</code> and other is in <code class="language-plaintext highlighter-rouge">Active/Active</code> mode.</p>

<h3 id="active--standby">Active / Standby</h3>

<p>On any planned maintenance or un-planned interruption affects active instance then within <code class="language-plaintext highlighter-rouge">90</code> seconds the standby gateway will become active <code class="language-plaintext highlighter-rouge">automatically</code> without any human involvement. This is excellent feature.</p>

<p><img src="https://i.imgur.com/fYtUs8W.png" alt="" class="full" /></p>

<h3 id="active-active">Active/ Active</h3>

<p>In this mode you have to deploy <code class="language-plaintext highlighter-rouge">2 VPN gateways</code> with 2 <code class="language-plaintext highlighter-rouge">distinct IP Addresses</code>. Then on-premise will have <code class="language-plaintext highlighter-rouge">2 VPN devices</code> to connect with them. With this you see how much traffic can be distributed among these 2 gateways.</p>

<p><img src="https://i.imgur.com/Uc42Bje.png" alt="" class="full" /></p>

<h2 id="site-to-site-vpn-gateway-deployment">Site to Site VPN Gateway Deployment</h2>

<p>Our goal is to create these 2 sites and connect them using vpn.</p>

<p><img src="https://i.imgur.com/ygx7RHO.png" alt="" class="full" /></p>

<h3 id="the-first-step-is-to-create-both-sites-in-azure">The first step is to create both sites in Azure.</h3>

<p>Let‚Äôs create HQ-Network and Azure-VNet1 sites in Azure.</p>

<h4 id="create-azure-vnet">Create Azure VNet</h4>

<p>While create <code class="language-plaintext highlighter-rouge">VNet</code>, we also create a <code class="language-plaintext highlighter-rouge">services</code> subnet. You need <code class="language-plaintext highlighter-rouge">Address-Prefixes</code> and <code class="language-plaintext highlighter-rouge">Subnet-Prefixes</code>.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">az</span><span class="w"> </span><span class="nx">network</span><span class="w"> </span><span class="nx">vnet</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--resource-group</span><span class="w"> </span><span class="n">learn-a6e8a4cb-44d7-4c35-b40c-9a61faff22e0</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--name</span><span class="w"> </span><span class="n">Azure-VNet-1</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--address-prefixes</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="nf">0</span><span class="o">.</span><span class="nf">0</span><span class="n">/16</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--subnet-name</span><span class="w"> </span><span class="n">Services</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--subnet-prefixes</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="nf">0</span><span class="o">.</span><span class="nf">0</span><span class="n">/24</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/4umnnbA.png" alt="" class="full" /></p>

<h4 id="create-gatewaysubnet">Create GatewaySubnet</h4>

<p>We need Gateway subnet to be created and for that we need <code class="language-plaintext highlighter-rouge">address-prefixes</code>. <code class="language-plaintext highlighter-rouge">GatewaySubnet</code> will remain under <code class="language-plaintext highlighter-rouge">Azure-VNet1</code>.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">az</span><span class="w"> </span><span class="nx">network</span><span class="w"> </span><span class="nx">vnet</span><span class="w"> </span><span class="nx">subnet</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--resource-group</span><span class="w"> </span><span class="n">learn-a6e8a4cb-44d7-4c35-b40c-9a61faff22e0</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--vnet-name</span><span class="w"> </span><span class="n">Azure-VNet-1</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--address-prefixes</span><span class="w"> </span><span class="mf">10.0</span><span class="o">.</span><span class="nf">255</span><span class="o">.</span><span class="nf">0</span><span class="n">/27</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--name</span><span class="w"> </span><span class="n">GatewaySubnet</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/MeuR0jg.png" alt="" class="full" /></p>

<h4 id="local-network-gateway-representing-head-quarter-vnet">Local Network Gateway representing Head Quarter VNet</h4>

<p>The Local Network Gateway(LNG) is a specific object that represents your on-premises location (the site) for routing purposes. You give the site a name by which Azure can refer to it, then specify the IP address of the on-premises VPN device to which you will create a connection.</p>

<p>Local Network Gateway will point to gateway ip address which is the Public IP(PIP) Address of the Head Quarter Network. I will assign this ip address later once I create PIP of HQ-Network.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">az</span><span class="w"> </span><span class="nx">network</span><span class="w"> </span><span class="nx">local-gateway</span><span class="w"> </span><span class="nx">create</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--resource-group</span><span class="w"> </span><span class="n">learn-a6e8a4cb-44d7-4c35-b40c-9a61faff22e0</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--gateway-ip-address</span><span class="w"> </span><span class="mf">94.0</span><span class="o">.</span><span class="nf">252</span><span class="o">.</span><span class="nf">160</span><span class="w"> </span><span class="n">\</span><span class="w">
    </span><span class="nt">--name</span><span class="w"> </span><span class="nx">LNG-HQ-Network</span><span class="w"> </span><span class="nx">\</span><span class="w">
    </span><span class="nt">--local-address-prefixes</span><span class="w"> </span><span class="mf">172.16</span><span class="o">.</span><span class="nf">0</span><span class="o">.</span><span class="nf">0</span><span class="n">/16</span><span class="w">

</span></code></pre></div></div>

<p><img src="https://i.imgur.com/YDeLkLE.png" alt="" class="full" /></p>

<p>Similarly, you go ahead and create Site for Head Quarter Network also.</p>

<h4 id="verify-network-topology">Verify Network Topology</h4>

<p><img src="https://i.imgur.com/huDWqOx.png" alt="" class="full" /></p>

<h3 id="2nd-step-create-a-site-to-site-vpn-gateway-by-using-azure-cli-commands">2nd Step Create a site-to-site VPN gateway by using Azure CLI commands</h3>

<p>We will create:</p>

<ul>
  <li>VNet for gateway</li>
  <li>VPN gateways</li>
  <li>Public IP Address</li>
  <li>Create connection</li>
</ul>

<p><img src="https://i.imgur.com/lKamVzY.png" alt="" class="full" /></p>

<p>Here is the <a href="https://docs.microsoft.com/en-us/learn/modules/connect-on-premises-network-with-vpn-gateway/3-exercise-prepare-azure-and-on-premises-vnets-using-azure-cli-commands">hands on lab link</a></p>

<hr />

<p><em>Thanks for reading my article till end. I hope you learned something special today. If you enjoyed this article then please share to your friends and if you have suggestions or thoughts to share with me then please write in the comment box.</em></p>

<div class="notice--success">
<strong>üíñ Say üëã to me!</strong>
<br />Rupesh Tiwari
<br />Founder of <a href="https://www.fullstackmaster.net">Fullstack Master </a>
<br />Email: <a href="mailto:rupesh.tiwari.info@gmail.com?subject=Hi">rupesh.tiwari.info@gmail.com</a>
<br />Website: <a href="https://www.rupeshtiwari.com">RupeshTiwari.com </a>
</div>
<p><img src="https://imgur.com/5fBatz9.png" alt="" /></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#azure" class="page__taxonomy-item" rel="tag">azure</a><span class="sep">, </span>
    
      <a href="/tags/#beginners" class="page__taxonomy-item" rel="tag">beginners</a><span class="sep">, </span>
    
      <a href="/tags/#tutorial" class="page__taxonomy-item" rel="tag">tutorial</a><span class="sep">, </span>
    
      <a href="/tags/#webdev" class="page__taxonomy-item" rel="tag">webdev</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-10-06T00:00:00+00:00">October 6, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rupeshtiwari_co&text=Azure+VPN+Gateway+for+Site+to+Site+Connection%20https%3A%2F%2Fwww.rupeshtiwari.com%2Fazure-vpn-gateway-for-site-to-site-connection%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.rupeshtiwari.com%2Fazure-vpn-gateway-for-site-to-site-connection%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.rupeshtiwari.com%2Fazure-vpn-gateway-for-site-to-site-connection%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/azure-blob-access-tiers-and-lifecycle-management/" class="pagination--pager" title="Azure Blob Access Tiers and Lifecycle Management
">Previous</a>
    
    
      <a href="/azure-storage-replications-basics/" class="pagination--pager" title="Azure Storage Replications Basics
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/qxXxmBa.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/mandatory-algorithms-for-coding-interview/" rel="permalink">Mandatory Algorithms for Coding Interview
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Basic algorithms that you must know if you want to crack your coding interview. In case you are starting to prepare for coding practice then make sure you...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/qxXxmBa.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/application-and-service-principal-objects-in-azure/" rel="permalink">Application and Service Principal Objects in Azure
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">Application and Service Principal Objects in Azure

</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/8axKkdp.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-improve-reliability-in-the-cloud/" rel="permalink">How to improve Reliability in the cloud?
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Did you get a phone call from your customer saying they want to improve their application reliability while you move their workload to the cloud? If yes t...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/7tGRoEv.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cost-optimization-with-aws-spot-ec2-instances/" rel="permalink">Cost Optimization with Amazon EC2 Spot Instances
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instanc...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script data-ad-client="ca-pub-1700383344966810" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Disable Inspection Function -->
<script type="text/javascript">
  
</script>
<script>
    document.onkeydown = function (e) {
        if (event.keyCode == 123) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
            return false;
        }
    }
</script>
<div id='tawk_5eff6dee223d045fcb7b449a'></div>
<!--Start of Tawk.to Script-->
<script type="text/javascript">
    var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
    (function () {
        var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src = 'https://embed.tawk.to/5eff6dee223d045fcb7b449a/default';
        s1.charset = 'UTF-8';
        s1.setAttribute('crossorigin', '*');
        s0.parentNode.insertBefore(s1, s0);
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.9.2/mermaid.min.js"></script>
<script>
    mermaid.initialize({ startOnLoad: true });
</script>
<link rel="stylesheet" href="/assets/css/blog.css">
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.rupeshtiwari.com/posts" rel="nofollow noopener noreferrer"><i class="fas fa-registered" aria-hidden="true"></i> Blogs for Developers</a></li>
        
      
        
          <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://fullstackmaster.net/course/3/mastering-meanjs" rel="nofollow noopener noreferrer"><i class="fab fa-angular" aria-hidden="true"></i> Learn Angular</a></li>
        
      
        
          <li><a href="https://github.com/rupeshtiwari#javascript-for-beginners-client-side" rel="nofollow noopener noreferrer"><i class="fas fa-crown" aria-hidden="true"></i> Become Software Developer Free</a></li>
        
      
        
          <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i> Medium</a></li>
        
      
        
          <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i> Dev.to</a></li>
        
      
        
          <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i> Fullstack Master</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2023 Rupesh Tiwari - Founder of Fullstack Master. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://www.rupeshtiwari.com/azure-vpn-gateway-for-site-to-site-connection/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/azure-vpn-gateway-for-site-to-site-connection"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-rupeshtiwari-github-io-1.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
