<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>PowerShell Random Notes for You! - Rupesh Tiwari - Founder of Fullstack Master</title>
<meta name="description" content="Learn some important built-in very helpful methods in Powershell. It could be a quick note for you so don‚Äôt forget to bookmark this article!">


  <meta name="author" content="Rupesh Tiwari">
  
  <meta property="article:author" content="Rupesh Tiwari">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rupesh Tiwari - Founder of Fullstack Master">
<meta property="og:title" content="PowerShell Random Notes for You!">
<meta property="og:url" content="https://www.rupeshtiwari.com/powershell-random-notes/">


  <meta property="og:description" content="Learn some important built-in very helpful methods in Powershell. It could be a quick note for you so don‚Äôt forget to bookmark this article!">



  <meta property="og:image" content="https://i.imgur.com/qxXxmBa.png">



  <meta name="twitter:site" content="@rupeshtiwari_co">
  <meta name="twitter:title" content="PowerShell Random Notes for You!">
  <meta name="twitter:description" content="Learn some important built-in very helpful methods in Powershell. It could be a quick note for you so don‚Äôt forget to bookmark this article!">
  <meta name="twitter:url" content="https://www.rupeshtiwari.com/powershell-random-notes/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://i.imgur.com/qxXxmBa.png">
  

  



  <meta property="article:published_time" content="2021-05-26T00:00:00+00:00">





  
    <meta property="article:publisher" content="https://www.facebook.com/fullstackmaster1">
  

  
    <meta property="fb:app_id" content="421181512329379">
  


<link rel="canonical" href="https://www.rupeshtiwari.com/powershell-random-notes/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://www.rupeshtiwari.com/"
    
  }
</script>



  <meta name="msvalidate.01" content="8BC08291167B3E15CC4FCC21C5895052">




<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rupesh Tiwari - Founder of Fullstack Master Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Rupesh Tiwari
          <span class="site-subtitle">Sr. Software Architect, Author & Trainer</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li><li class="masthead__menu-item">
              <a href="https://youtube.com/fullstackmaster">youtube</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/consulting/">consulting</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.fullstackmaster.net/pro">angular training</a>
            </li><li class="masthead__menu-item">
              <a href="https://fullstackmaster.net/login">sign in</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="https://i.imgur.com/zipiW93.png" alt="PowerShell Random Notes for You!" class="page__hero-image">
  
  
</div>




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://www.rupeshtiwari.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">PowerShell Random Notes for You!</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Rupesh Tiwari" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rupesh Tiwari</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I help students and professionals to become Full Stack Software Developer in less than a year!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="rupesh.tiwari.info@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="/posts/" rel="nofollow noopener noreferrer"><i class="fa fa-th-large" aria-hidden="true"></i><span class="label">Blogs</span></a></li>
          
        
          
            <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i><span class="label">Medium</span></a></li>
          
        
          
            <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i><span class="label">Dev.to</span></a></li>
          
        
          
            <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="http://twitter.com/rupeshtiwari_co" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="label">Angular Training</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="PowerShell Random Notes for You!">
    <meta itemprop="description" content="  Learn some important built-in very helpful methods in Powershell. It could be a quick note for you so don‚Äôt forget to bookmark this article! ü•á">
    <meta itemprop="datePublished" content="2021-05-26T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">PowerShell Random Notes for You!
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#try-catch-in-powershell">Try Catch in PowerShell</a></li><li><a href="#try-catch-finally-in-powershell">Try Catch Finally in Powershell</a></li><li><a href="#if-else-case-in-powershell">if else case in Powershell</a></li><li><a href="#throwing-custom-error-in-powershell">Throwing custom error in Powershell</a></li><li><a href="#multiple-line-comment-in-powershell">Multiple line comment in Powershell</a></li><li><a href="#contains-vs-match-vs-like-in-powershell">Contains vs Match vs Like in Powershell</a></li><li><a href="#un-archive-zip-file">Un-archive zip file</a><ul><li><a href="#using-expand-archive-cmdlet">Using Expand-Archive cmdlet</a></li><li><a href="#using-net-class-systemiocompressionzipfile">Using .Net class [System.IO.Compression.ZipFile]</a></li><li><a href="#using-foldercopyhere-method-of-shellapplication-class">Using Folder.CopyHere() Method of Shell.Application Class</a></li></ul></li><li><a href="#references">References</a></li><li><a href="#become-full-stack-developer-">Become full stack developer üíª</a></li></ul>

            </nav>
          </aside>
        
        <blockquote>
  <p>Learn some important built-in very helpful methods in Powershell. It could be a quick note for you so don‚Äôt forget to bookmark this article! ü•á</p>
</blockquote>

<h2 id="try-catch-in-powershell">Try Catch in PowerShell</h2>

<p>Using built-in exceptions.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="nv">$wc</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new-object</span><span class="w"> </span><span class="nx">System.Net.WebClient</span><span class="w">
   </span><span class="nv">$wc</span><span class="o">.</span><span class="nf">DownloadFile</span><span class="p">(</span><span class="s2">"http://www.contoso.com/MyDoc.doc"</span><span class="p">,</span><span class="s2">"c:\temp\MyDoc.doc"</span><span class="p">)</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">[</span><span class="n">System.Net.WebException</span><span class="p">],[</span><span class="n">System.IO.IOException</span><span class="p">]</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"Unable to download MyDoc.doc from http://www.contoso.com."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="s2">"An error occurred that could not be resolved."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Printing Anonymous Exception details.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">NonsenseString</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"An error occurred:"</span><span class="w">
  </span><span class="n">Write-Host</span><span class="w"> </span><span class="bp">$_</span><span class="w">
  </span><span class="c"># will print the error details.</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<pre><code class="language-error">An Error occurred:
The term 'NonsenseString' is not recognized as the name of a cmdlet, function,
script file, or operable program. Check the spelling of the name, or if a path
was included, verify that the path is correct and try again.
</code></pre>

<h2 id="try-catch-finally-in-powershell">Try Catch Finally in Powershell</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">try</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">NonsenseString</span><span class="w"> </span><span class="p">}</span><span class="w">
</span><span class="kr">catch</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"An error occurred:"</span><span class="w">
  </span><span class="n">Write-Host</span><span class="w"> </span><span class="bp">$_</span><span class="w">
  </span><span class="c"># will print the error details.</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="kr">finally</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">Write-Host</span><span class="w"> </span><span class="s2">"I can move temporary log file to permanent location."</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="if-else-case-in-powershell">if else case in Powershell</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">if</span><span class="p">(</span><span class="n">Boolean_expression</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">//</span><span class="w"> </span><span class="nx">Executes</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Boolean</span><span class="w"> </span><span class="nx">expression</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">true</span><span class="w">
</span><span class="p">}</span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">//</span><span class="w"> </span><span class="nx">Executes</span><span class="w"> </span><span class="nx">when</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Boolean</span><span class="w"> </span><span class="nx">expression</span><span class="w"> </span><span class="nx">is</span><span class="w"> </span><span class="nx">false</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<ul>
  <li><strong>-eq</strong> to check <strong>equality</strong>.</li>
  <li><strong>-le</strong> to check <strong>less than</strong>.</li>
</ul>

<p>Example: Comparing Less than in Powershell</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">30</span><span class="w">

</span><span class="kr">if</span><span class="p">(</span><span class="nv">$x</span><span class="w"> </span><span class="o">-le</span><span class="w"> </span><span class="mi">18</span><span class="p">){</span><span class="w">
   </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"You can't get driving license!"</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
   </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"You are eligible for Driving License!"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<p>Example: Comparing equality check</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$file1Timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">datetime</span><span class="p">](</span><span class="n">get-date</span><span class="w"> </span><span class="nt">-date</span><span class="w"> </span><span class="s1">'1989-09-25 8AM'</span><span class="p">)</span><span class="w">

</span><span class="nv">$file2Timestamp</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">[</span><span class="n">datetime</span><span class="p">](</span><span class="n">get-date</span><span class="w"> </span><span class="nt">-date</span><span class="w"> </span><span class="s1">'1989-09-25 10AM'</span><span class="p">)</span><span class="w">

</span><span class="kr">if</span><span class="p">(</span><span class="nv">$file1Timestamp</span><span class="w"> </span><span class="o">-eq</span><span class="w"> </span><span class="nv">$file2Timestamp</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"File is not modified"</span><span class="w">
</span><span class="p">}</span><span class="w"> </span><span class="kr">else</span><span class="w"> </span><span class="p">{</span><span class="w">
    </span><span class="n">write-host</span><span class="w"> </span><span class="s2">"File is modified"</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="throwing-custom-error-in-powershell">Throwing custom error in Powershell</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kr">Function</span><span class="w"> </span><span class="nf">Do-Something</span><span class="w">
</span><span class="p">{</span><span class="w">
    </span><span class="kr">throw</span><span class="w"> </span><span class="s2">"Your custom error"</span><span class="w">
    </span><span class="c"># This creates a runtime exception</span><span class="w">
    </span><span class="c"># that is a terminating error.</span><span class="w">
</span><span class="p">}</span><span class="w">
</span></code></pre></div></div>

<h2 id="multiple-line-comment-in-powershell">Multiple line comment in Powershell</h2>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cm">&lt;#
Function Do-Something
{
Write-Host "The entire function is commented"
}
#&gt;</span><span class="w">
</span></code></pre></div></div>

<h2 id="contains-vs-match-vs-like-in-powershell">Contains vs Match vs Like in Powershell</h2>

<p><code class="language-plaintext highlighter-rouge">Contains</code> is used for collection and <strong>Tells whether a collection of reference values includes a single test value.</strong></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"abc"</span><span class="w"> </span><span class="o">-contains</span><span class="w"> </span><span class="s2">"b"</span><span class="w"> </span><span class="c"># return False</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/H8GQoBu.png" alt="" /></p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="s2">"abc"</span><span class="p">,</span><span class="s2">"xyz"</span><span class="w"> </span><span class="o">-contains</span><span class="w"> </span><span class="s2">"abc"</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/xvK8KsJ.png" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">Match</code> is used in string and it uses regular expression to search in string.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"c:\temp\web\config.js"</span><span class="w"> </span><span class="o">-match</span><span class="w"> </span><span class="s2">"b\\config.js"</span><span class="w"> </span><span class="c"># True</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/MtYadup.png" alt="" /></p>

<p><code class="language-plaintext highlighter-rouge">Like</code> is used in string and it uses wild card search</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="s2">"c:\temp\web\config.js"</span><span class="w"> </span><span class="o">-like</span><span class="w"> </span><span class="s2">"*b\config.js"</span><span class="w"> </span><span class="c"># True</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://i.imgur.com/jgeLl0t.png" alt="" /></p>

<p>Whenever error occurs in batch file it save the error code in the environment variable <code class="language-plaintext highlighter-rouge">%ERRORLEVEL%</code></p>

<div class="language-shell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nb">echo</span> <span class="s2">"Return¬†Code:"</span> %ERRORLEVEL%
</code></pre></div></div>

<h2 id="un-archive-zip-file">Un-archive zip file</h2>

<h3 id="using-expand-archive-cmdlet">Using Expand-Archive cmdlet</h3>

<p><code class="language-plaintext highlighter-rouge">Expand-Archive</code> is built-in powershell 5 module.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="w"> </span><span class="n">expand-archive</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="nx">c:\fsms\test.zip</span><span class="w"> </span><span class="nt">-destinationpath</span><span class="w"> </span><span class="nx">c:\fsms\unpack</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://imgur.com/gxliBJQ.png" alt="" class="full" /></p>

<h3 id="using-net-class-systemiocompressionzipfile">Using .Net class [System.IO.Compression.ZipFile]</h3>

<p><code class="language-plaintext highlighter-rouge">ZipFile.ExtractToDirectory()</code> is .Net Framework 4.5 built-in api.</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[</span><span class="n">System.IO.Compression.ZipFile</span><span class="p">]::</span><span class="n">ExtractToDirectory</span><span class="p">(</span><span class="s2">"c:\fsms\test.zip"</span><span class="p">,</span><span class="s2">"c:\fsms\unpack"</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://imgur.com/Ku8Q3t5.gif" alt="" class="full" /></p>

<h3 id="using-foldercopyhere-method-of-shellapplication-class">Using Folder.CopyHere() Method of Shell.Application Class</h3>

<p>Using <code class="language-plaintext highlighter-rouge">COM object</code> created from <code class="language-plaintext highlighter-rouge">Shell.Application</code> class. Use <code class="language-plaintext highlighter-rouge">namespace().items()</code> to get all items then copy them to destination folder. Make sure destination folder exist before you copy. Also this way of un-archiving files seems lil lengthy. However, I found that COM method to un-archive files are reliable since it is not modifying the modified date time of the files inside the zip file.</p>

<p class="notice--success">üèÜ <strong>Pro Tip</strong> <br />
<br />
For example if there is a file called as <code class="language-plaintext highlighter-rouge">Web.config</code> inside your <code class="language-plaintext highlighter-rouge">web.zip\Content\website</code> folder. Then if the actual modified date time is <code class="language-plaintext highlighter-rouge">5/4/2021 07:00:11 AM</code> then this will show exact same time. However, if u use powershell cmdlet <code class="language-plaintext highlighter-rouge">Expand-Archive</code> or .Net <code class="language-plaintext highlighter-rouge">ExtractToDirectory</code> methods they will sometime display <code class="language-plaintext highlighter-rouge">+1</code> hour so they will show file <code class="language-plaintext highlighter-rouge">lastwritetime</code> as <code class="language-plaintext highlighter-rouge">5/4/2021 08:00:11 AM</code>. Note here it is showing <code class="language-plaintext highlighter-rouge">8AM</code> rather <code class="language-plaintext highlighter-rouge">7AM</code>.</p>

<p>Example:</p>

<div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$shell</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">new-object</span><span class="w"> </span><span class="nt">-com</span><span class="w"> </span><span class="nx">Shell.Application</span><span class="w">
</span><span class="nv">$targetFolderToCopyUnzippedFiles</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c:\fsms\unpack"</span><span class="w">
</span><span class="c"># create a target folder if not exist. Make sure you have the folder otherwise un-archive will fail.</span><span class="w">
</span><span class="kr">if</span><span class="p">(</span><span class="o">!</span><span class="p">(</span><span class="n">test-path</span><span class="w"> </span><span class="nv">$targetFolderToCopyUnzippedFiles</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
  </span><span class="n">new-item</span><span class="w"> </span><span class="nt">-itemtype</span><span class="w"> </span><span class="nx">directory</span><span class="w"> </span><span class="nt">-path</span><span class="w"> </span><span class="nv">$targetFolderToCopyUnzippedFiles</span><span class="w"> </span><span class="nt">-force</span><span class="w">
</span><span class="p">}</span><span class="w">
</span><span class="nv">$zipFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">"c:\fsms\test.zip"</span><span class="w">
</span><span class="c"># Unarchive and copy to target folder</span><span class="w">
</span><span class="nv">$shell</span><span class="o">.</span><span class="nf">namespace</span><span class="p">(</span><span class="nv">$targetFolderToCopyUnzippedFiles</span><span class="p">)</span><span class="o">.</span><span class="nf">copyhere</span><span class="p">(</span><span class="nv">$shell</span><span class="o">.</span><span class="nf">namespace</span><span class="p">(</span><span class="nv">$zipFile</span><span class="p">)</span><span class="o">.</span><span class="nf">items</span><span class="p">(),</span><span class="nx">4</span><span class="p">)</span><span class="w">
</span></code></pre></div></div>

<p><img src="https://imgur.com/e904y8V.gif" alt="" class="full" /></p>

<h2 id="references">References</h2>

<ul>
  <li>https://ridicurious.com/2019/07/29/3-ways-to-unzip-compressed-files-using-powershell/</li>
</ul>

<p>If you know any other Powershell Built-In method that you use frequently then please write them in comment box. I may add those method details in this blog :slightly_smiling_face üôÇ</p>

<hr />

<p><em>Thanks for reading my article till end. I hope you learned something special today. If you enjoyed this article then please share to your friends and if you have suggestions or thoughts to share with me then please write in the comment box.</em></p>

<h2 id="become-full-stack-developer-">Become full stack developer üíª</h2>

<p class="notice--info">I teach at <a href="https://www.fullstackmaster.net">Fullstack Master</a>. If you want to become <strong>Software Developer</strong> and grow your carrier as new <strong>Software Engineer</strong> or <strong>Lead Developer/Architect</strong>. Consider subscribing to our full stack development training programs. You will learn <strong>Angular, RxJS, JavaScript, System Architecture</strong> and much more with lots of <strong>hands on coding</strong>. We have All-Access Monthly membership plans and you will get unlimited access to all of our <strong>video</strong> courses, <strong>slides</strong>, <strong>download source code</strong> &amp; <strong>Monthly video calls</strong>.</p>

<ul>
  <li>Please subscribe to <strong><a href="https://www.fullstackmaster.net/pro">All-Access Membership PRO plan</a></strong> to access <em>current</em> and <em>future</em> <strong>angular, node.js</strong> and related courses.</li>
  <li>Please subscribe to <strong><a href="https://www.fullstackmaster.net/elite">All-Access Membership ELITE plan</a></strong> to get everything from PRO plan. Additionally, you will get access to a monthly <strong>live Q&amp;A video call</strong> with <code class="language-plaintext highlighter-rouge">Rupesh</code> and you can ask <strong><em>doubts/questions</em></strong> and get more help, tips and tricks.</li>
</ul>

<p class="notice--warning">Your bright future is awaiting for you so visit today <a href="www.fullstackmaster.net">FullstackMaster</a> and allow me to help you to board on your dream software company as a new <strong>Software Developer, Architect or Lead Engineer</strong> role.</p>

<div class="notice--success">
<strong>üíñ Say üëã to me!</strong>
<br />Rupesh Tiwari
<br />Founder of <a href="https://www.fullstackmaster.net">Fullstack Master </a>
<br />Email: <a href="mailto:rupesh.tiwari.info@gmail.com?subject=Hi">rupesh.tiwari.info@gmail.com</a>
<br />Website: <a href="https://www.rupeshtiwari.com">RupeshTiwari.com </a>
</div>
<p><img src="https://imgur.com/5fBatz9.png" alt="" /></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#beginners" class="page__taxonomy-item" rel="tag">beginners</a><span class="sep">, </span>
    
      <a href="/tags/#powershell" class="page__taxonomy-item" rel="tag">powershell</a><span class="sep">, </span>
    
      <a href="/tags/#tutorial" class="page__taxonomy-item" rel="tag">tutorial</a><span class="sep">, </span>
    
      <a href="/tags/#webdev" class="page__taxonomy-item" rel="tag">webdev</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-05-26T00:00:00+00:00">May 26, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rupeshtiwari_co&text=PowerShell+Random+Notes+for+You%21%20https%3A%2F%2Fwww.rupeshtiwari.com%2Fpowershell-random-notes%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.rupeshtiwari.com%2Fpowershell-random-notes%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.rupeshtiwari.com%2Fpowershell-random-notes%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/microsoft-azure-services-and-concepts/" class="pagination--pager" title="Microsoft Azure Services and Concepts
">Previous</a>
    
    
      <a href="/introduction-to-azure-fundamentals/" class="pagination--pager" title="Introduction to Azure Fundamentals
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/8axKkdp.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-improve-reliability-in-the-cloud/" rel="permalink">How to improve Reliability in the cloud?
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Did you get a phone call from your customer saying they want to improve their application reliability while you move their workload to the cloud? If yes t...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/7tGRoEv.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cost-optimization-with-aws-spot-ec2-instances/" rel="permalink">Cost Optimization with Amazon EC2 Spot Instances
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instanc...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/WQWdzrb.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cloud-security-defense-in-depth-azure-approach/" rel="permalink">Cloud Security Defense In-Depth Azure Approach
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  In a traditional data center you create one perimeter, secure them by installing firewall, WAF, SIEMS etc. and have 100% confidence that the data center i...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/aPeeiUM.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-maintain-well-architected-framework-on-cloud/" rel="permalink">How to Maintain Well-Architected-Framework on Cloud
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">How to make sure our workload in the cloud is secure, reliable. How to monitor the cost of your cloud resources consumption? Is there any automation you can ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script data-ad-client="ca-pub-1700383344966810" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Disable Inspection Function -->
<script type="text/javascript">
  
</script>
<script>
    document.onkeydown = function (e) {
        if (event.keyCode == 123) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
            return false;
        }
    }
</script>
<div id='tawk_5eff6dee223d045fcb7b449a'></div>
<!--Start of Tawk.to Script-->
<script type="text/javascript">
    var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
    (function () {
        var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src = 'https://embed.tawk.to/5eff6dee223d045fcb7b449a/default';
        s1.charset = 'UTF-8';
        s1.setAttribute('crossorigin', '*');
        s0.parentNode.insertBefore(s1, s0);
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.9.2/mermaid.min.js"></script>
<script>
    mermaid.initialize({ startOnLoad: true });
</script>
<link rel="stylesheet" href="/assets/css/blog.css">
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.rupeshtiwari.com/posts" rel="nofollow noopener noreferrer"><i class="fas fa-registered" aria-hidden="true"></i> Blogs for Developers</a></li>
        
      
        
          <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://fullstackmaster.net/course/3/mastering-meanjs" rel="nofollow noopener noreferrer"><i class="fab fa-angular" aria-hidden="true"></i> Learn Angular</a></li>
        
      
        
          <li><a href="https://github.com/rupeshtiwari#javascript-for-beginners-client-side" rel="nofollow noopener noreferrer"><i class="fas fa-crown" aria-hidden="true"></i> Become Software Developer Free</a></li>
        
      
        
          <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i> Medium</a></li>
        
      
        
          <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i> Dev.to</a></li>
        
      
        
          <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i> Fullstack Master</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rupesh Tiwari - Founder of Fullstack Master. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://www.rupeshtiwari.com/powershell-random-notes/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/powershell-random-notes"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-rupeshtiwari-github-io-1.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
