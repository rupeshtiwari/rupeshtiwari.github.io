<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Branch protection in Azure DevOps - Rupesh Tiwari - Founder of Fullstack Master</title>
<meta name="description" content="Learn how to protect Master branch of git repository in azure devops">


  <meta name="author" content="Rupesh Tiwari">
  
  <meta property="article:author" content="Rupesh Tiwari">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rupesh Tiwari - Founder of Fullstack Master">
<meta property="og:title" content="Branch protection in Azure DevOps">
<meta property="og:url" content="https://www.rupeshtiwari.com/branch-protection-in-azure-devops/">


  <meta property="og:description" content="Learn how to protect Master branch of git repository in azure devops">



  <meta property="og:image" content="https://i.imgur.com/S8uujlY.jpg">



  <meta name="twitter:site" content="@rupeshtiwari_co">
  <meta name="twitter:title" content="Branch protection in Azure DevOps">
  <meta name="twitter:description" content="Learn how to protect Master branch of git repository in azure devops">
  <meta name="twitter:url" content="https://www.rupeshtiwari.com/branch-protection-in-azure-devops/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://i.imgur.com/S8uujlY.jpg">
  

  



  <meta property="article:published_time" content="2021-01-19T19:00:00-05:00">





  
    <meta property="article:publisher" content="https://www.facebook.com/fullstackmaster1">
  

  
    <meta property="fb:app_id" content="421181512329379">
  


<link rel="canonical" href="https://www.rupeshtiwari.com/branch-protection-in-azure-devops/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://www.rupeshtiwari.com/"
    
  }
</script>



  <meta name="msvalidate.01" content="8BC08291167B3E15CC4FCC21C5895052">




<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rupesh Tiwari - Founder of Fullstack Master Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Rupesh Tiwari
          <span class="site-subtitle">Sr. Software Architect, Author & Trainer</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li><li class="masthead__menu-item">
              <a href="https://youtube.com/fullstackmaster">youtube</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/consulting/">consulting</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.fullstackmaster.net/pro">angular training</a>
            </li><li class="masthead__menu-item">
              <a href="https://fullstackmaster.net/login">sign in</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="https://i.imgur.com/S8uujlY.jpg" alt="Branch protection in Azure DevOps" class="page__hero-image">
  
  
</div>




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://www.rupeshtiwari.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Branch protection in Azure DevOps</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Rupesh Tiwari" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rupesh Tiwari</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I help students and professionals to become Full Stack Software Developer in less than a year!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="rupesh.tiwari.info@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="/posts/" rel="nofollow noopener noreferrer"><i class="fa fa-th-large" aria-hidden="true"></i><span class="label">Blogs</span></a></li>
          
        
          
            <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i><span class="label">Medium</span></a></li>
          
        
          
            <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i><span class="label">Dev.to</span></a></li>
          
        
          
            <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="http://twitter.com/rupeshtiwari_co" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="label">Angular Training</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Branch protection in Azure DevOps">
    <meta itemprop="description" content="Protecting Master Branch from Bad Pull Requests is big challenge now a dayswhile working in a team. You are working on git with distributed architecture.Where many team members are creating pull request and adding their code toMASTER/MAIN branch. It is important to protect our master branch such that ifsome wrong code or failing build code or failing test code is pushed by someteam member. Then you do not want to get that code pulled or merged in MASTERbranch.In this article I will explain you how can you protect git master branch fromaccidental merge of failing code from some pull request in your Azure Repos.Issue: Creating Pull Request with Failing BuildWork on New Feature BranchCreate new feature branch and write some bad code so that build failed.Build is failing in New Feature BranchNotice your build is failing in local machine. Go ahead and push your code in your featurebranch.Creating Pull Request to merge bad codeFollow steps to create pull request to merge this breaking code in masterbranch.  Go to git repository and click on Pull Requests tab.  Select Compare &amp; Pull Request button.  Add comment and create pull requestNotice wrong code is merged in master branch even though its build is failing itgot merged.See build failed still code got merged. This is not desirable.We want to not merge the code until its build is passing.Protecting Master Branch in Azure ReposIn this example I will setup some policy assuming the code writer is admin. Inreal world you may have different group of people who are the code reviewers andcode approvers.Configure branch policiesSelect Repos &gt; Branches to open the Branches page in the web portal.Locate your branch in the page.Select the ‚Ä¶ button. Select Branch policies from the context menu.Require a minimum number of reviewersThe basic policy requires that a code writer can review &amp; approve the code withno rejections. Check for linked work itemsRequire associations between pull requests and a work item to ensure thatchanges to your branch have work item management tracking.Build ValidationSet a policy requiring changes in a pull request to build successfully with theprotected branch before the pull request can be completed. Build policies reducebreaks and keep your test results passing.If a build validation policy is enabled, a new build is queued when either a newpull request is created, or if changes are pushed to an existing pull requesttargeting the branch. The build policy then evaluates the results of the buildto determine whether the pull request can be completed.Choose the + button next to Build validation.  Select the Build pipeline.  Choose the type of Trigger. Select Automatic (whenever the source branch isupdated)  Select the Policy requirement. If you choose Required, builds must completesuccessfully to complete pull requests  After 12 hours if master has been updated. This choice is excellent forreducing the number of builds when your protected branch has frequentupdates.  Enter an optional Display name for this build policy. This name identifiesthe policy on the Branch policies page. If you don‚Äôt specify a display name,the policy uses the build pipeline name. Select Save.Finally you will see the badge in the master branch which denotes that yourbranch has policy setup done. Create Failing Build Pull Request After Branch Policy AppliedNow lets create a pull request with the code base where build is failing.Notice build is failing locally Now let me create a pull request and see if this code can be merged to masterbranch.While creating pull request notice it automatically triggered the pull requestbuild.  Assign some reviewer I will put my self  Don‚Äôt link any task and notice build process started as soon as I create pullrequest.    Since I did not link task it is saying Work items must be linked since thiswas in the branch policy. After waiting some time notice our build failedwhich was expected  Notice master branchis un-changed since the build failed. Even though we link some task this build is failing so one of the rule is notsatisfied and hence code will never merge to master branch. We successfully,protected our MASTER branch.Lets create pull request with working code  First I will assign work item to at-least pass that rule.   Next it is asking that ‚ÄúRupesh Tiwari‚Äù must approveSo lets approve this pull request as well.Notice now only policy is failing is the build. Our build is failing.Lets go to the source code and fix the code and check-in to the feature branch.Notice Automatically, our build will be triggered on the same pull request.Notice build succeed this time. Complete the pull request I will select Squash commitOnce you complete merge then again it will trigger a build which will run inmaster branch.Finally code will be submitted to master branch.Can I push changes directly to a branch after a branch policy is configured?No, If you try to directly change the master branch it will show error saying umust create pull request. Which is good protection.Git Repo TagsNotice for each successful merge to master we see tags are created.Why do we see 2 build for one Pull RequestIf we create/update a PR, it will create a Pull request build, this build willonly trigger the release stage which enable the Pull request trigger. If wecomplete a PR, it will create a CI build, and this build will trigger therelease stage which enable CD. That‚Äôs how it is designed, because ifyour PR is not finished, every time you update the code (assuming the code isincorrect), your deployment will be triggered by this PR build, then thisdeployment must be meaningless(because your code has not been modified tocomplete), it will bring extra trouble to your deployment. The logic we designedis that only when you complete this PR (all error codes are modified) will a CIbuild be generated in the merge phase, which will trigger the CD.ReferenceImprove code quality with branch policiesWhy 2 Builds while protecting master branchConclusionWe successfully protected our master branch in the repo. However, thedis-advantage is now our builds are running 2 times for each pull request andmerge to master. This is the sacrifice that you have to do in order to protectyour branch.Become full stack developer üíªIf you want to become full stack developer and grow your carrier as new softwaredeveloper or Lead Developer/Architect. Consider subscribing to our full stackdevelopment training programs. We have All-Access Monthly membership plans andyou will get unlimited access to all of our video courses, slides, source code &amp;Monthly video calls.  Please subscribe toAll-Access Membership PRO plan toaccess current and future angular, node.js and related courses.  Please subscribe toAll-Access Membership ELITE plan toget everything from PRO plan. Additionally, you will get access to monthlylive Q&amp;A video call with Rupesh and you can ask doubts/questions and get morehelp, tips and tricks.  Your bright future is awaiting for you so visit todayFullstackMaster and allow me to help you to boardon your dream software company as a Developer,Architect or Lead Engineer role.üíñ Say üëã to me! Rupesh Tiwari  www.rupeshtiwari.com ‚úâÔ∏è  Email Rupesh Founder of  Fullstack Master">
    <meta itemprop="datePublished" content="2021-01-19T19:00:00-05:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Branch protection in Azure DevOps
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          6 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#issue-creating-pull-request-with-failing-build">Issue: Creating Pull Request with Failing Build</a><ul><li><a href="#work-on-new-feature-branch">Work on New Feature Branch</a></li><li><a href="#build-is-failing-in-new-feature-branch">Build is failing in New Feature Branch</a></li><li><a href="#creating-pull-request-to-merge-bad-code">Creating Pull Request to merge bad code</a></li></ul></li><li><a href="#protecting-master-branch-in-azure-repos">Protecting Master Branch in Azure Repos</a></li><li><a href="#configure-branch-policies">Configure branch policies</a><ul><li><a href="#require-a-minimum-number-of-reviewers">Require a minimum number of reviewers</a></li><li><a href="#check-for-linked-work-items">Check for linked work items</a></li></ul></li><li><a href="#build-validation">Build Validation</a></li><li><a href="#create-failing-build-pull-request-after-branch-policy-applied">Create Failing Build Pull Request After Branch Policy Applied</a></li><li><a href="#lets-create-pull-request-with-working-code">Lets create pull request with working code</a></li><li><a href="#can-i-push-changes-directly-to-a-branch-after-a-branch-policy-is-configured">Can I push changes directly to a branch after a branch policy is configured?</a></li><li><a href="#git-repo-tags">Git Repo Tags</a></li><li><a href="#why-do-we-see-2-build-for-one-pull-request">Why do we see 2 build for one Pull Request</a></li><li><a href="#reference">Reference</a></li><li><a href="#conclusion">Conclusion</a></li><li><a href="#become-full-stack-developer-">Become full stack developer üíª</a></li></ul>

            </nav>
          </aside>
        
        <p><strong>Protecting Master Branch from Bad Pull Requests</strong> is big challenge now a days
while working in a team. You are working on git with distributed architecture.
Where many team members are creating pull request and adding their code to
MASTER/MAIN branch. It is important to protect our master branch such that if
some wrong code or failing build code or failing test code is pushed by some
team member. Then you do not want to get that code pulled or merged in MASTER
branch.</p>

<p>In this article I will explain you how can you protect git master branch from
accidental merge of failing code from some pull request in your Azure Repos.</p>

<h2 id="issue-creating-pull-request-with-failing-build">Issue: Creating Pull Request with Failing Build</h2>

<h3 id="work-on-new-feature-branch">Work on New Feature Branch</h3>

<p>Create new feature branch and write some bad code so that build failed.
<img src="https://i.imgur.com/FfCMbOK.png" alt="" /></p>

<h3 id="build-is-failing-in-new-feature-branch">Build is failing in New Feature Branch</h3>

<p>Notice your build is failing in local machine.
<img src="https://i.imgur.com/CgeO5Lf.png" alt="" /> Go ahead and push your code in your feature
branch.</p>

<h3 id="creating-pull-request-to-merge-bad-code">Creating Pull Request to merge bad code</h3>

<p>Follow steps to create pull request to merge this breaking code in master
branch.</p>

<ol>
  <li>Go to git repository and click on <code class="language-plaintext highlighter-rouge">Pull Requests</code> tab.</li>
  <li>Select <code class="language-plaintext highlighter-rouge">Compare &amp; Pull Request</code> button.</li>
</ol>

<p><img src="https://i.imgur.com/ukdSenz.png" alt="" /></p>

<ol>
  <li>Add comment and create pull request</li>
</ol>

<p><img src="https://i.imgur.com/SZbaBXC.png" alt="" /></p>

<p><img src="https://i.imgur.com/Ic6rLJZ.png" alt="" /></p>

<p>Notice wrong code is merged in master branch even though its build is failing it
got merged.</p>

<p><img src="https://i.imgur.com/CJCxea3.png" alt="" /></p>

<p>See build failed still code got merged. This is not desirable.
<img src="https://i.imgur.com/t3DrwbI.png" alt="" /></p>

<p>We want to not merge the code until its build is passing.</p>

<h2 id="protecting-master-branch-in-azure-repos">Protecting Master Branch in Azure Repos</h2>

<p>In this example I will setup some policy assuming the code writer is admin. In
real world you may have different group of people who are the code reviewers and
code approvers.</p>

<h2 id="configure-branch-policies">Configure branch policies</h2>

<p>Select Repos &gt; Branches to open the Branches page in the web portal.
<img src="https://i.imgur.com/9v4HWEo.png" alt="" /></p>

<p>Locate your branch in the page.</p>

<p><img src="https://i.imgur.com/meKo9fX.png" alt="" /></p>

<p>Select the ‚Ä¶ button. Select Branch policies from the context menu.
<img src="https://i.imgur.com/shguSAM.png" alt="" /></p>

<h3 id="require-a-minimum-number-of-reviewers">Require a minimum number of reviewers</h3>

<p>The basic policy requires that a code writer can review &amp; approve the code with
no rejections. <img src="https://i.imgur.com/R8XdSKQ.png" alt="" /></p>

<h3 id="check-for-linked-work-items">Check for linked work items</h3>

<p>Require associations between pull requests and a work item to ensure that
changes to your branch have work item management tracking.</p>

<p><img src="https://i.imgur.com/HaU4TCU.png" alt="" /></p>

<h2 id="build-validation">Build Validation</h2>

<p>Set a policy requiring changes in a pull request to build successfully with the
protected branch before the pull request can be completed. Build policies reduce
breaks and keep your test results passing.</p>

<p>If a build validation policy is enabled, a new build is queued when either a new
pull request is created, or if changes are pushed to an existing pull request
targeting the branch. The build policy then evaluates the results of the build
to determine whether the pull request can be completed.</p>

<p>Choose the + button next to Build validation.
<img src="https://i.imgur.com/AvUBkiR.png" alt="" /></p>

<p><img src="https://i.imgur.com/WqgRGi5.png" alt="" /></p>

<ol>
  <li>Select the Build pipeline.</li>
  <li>Choose the type of Trigger. Select Automatic (whenever the source branch is
updated)</li>
  <li>Select the Policy requirement. If you choose Required, builds must complete
successfully to complete pull requests</li>
  <li>After 12 hours if master has been updated. This choice is excellent for
reducing the number of builds when your protected branch has frequent
updates.</li>
  <li>Enter an optional Display name for this build policy. This name identifies
the policy on the Branch policies page. If you don‚Äôt specify a display name,
the policy uses the build pipeline name. Select Save.</li>
</ol>

<p>Finally you will see the badge in the master branch which denotes that your
branch has policy setup done. <img src="https://i.imgur.com/IzM4ja1.png" alt="" /></p>

<h2 id="create-failing-build-pull-request-after-branch-policy-applied">Create Failing Build Pull Request After Branch Policy Applied</h2>

<p>Now lets create a pull request with the code base where build is failing.
<img src="https://i.imgur.com/bQeAxj2.png" alt="" /></p>

<p>Notice build is failing locally <img src="https://i.imgur.com/nbN4K9n.png" alt="" /></p>

<p>Now let me create a pull request and see if this code can be merged to master
branch.</p>

<p><img src="https://i.imgur.com/Z0vzaYg.png" alt="" /></p>

<p>While creating pull request notice it automatically triggered the pull request
build.</p>

<ol>
  <li>Assign some reviewer I will put my self</li>
  <li>Don‚Äôt link any task and notice build process started as soon as I create pull
request.</li>
  <li><img src="https://i.imgur.com/jetNhyb.png" alt="" /></li>
  <li>Since I did not link task it is saying Work items must be linked since this
was in the branch policy. After waiting some time notice our build failed
which was expected <img src="https://i.imgur.com/og6PAez.png" alt="" /> Notice master branch
is un-changed since the build failed. <img src="https://i.imgur.com/T1bTgZy.png" alt="" /></li>
</ol>

<p>Even though we link some task this build is failing so one of the rule is not
satisfied and hence code will never merge to master branch. We successfully,
protected our MASTER branch.</p>

<h2 id="lets-create-pull-request-with-working-code">Lets create pull request with working code</h2>

<ol>
  <li>First I will assign work item to at-least pass that rule.</li>
  <li><img src="https://i.imgur.com/6n1aw2a.png" alt="" /> <img src="https://i.imgur.com/C8EVCbc.png" alt="" /></li>
</ol>

<p>Next it is asking that ‚ÄúRupesh Tiwari‚Äù must approve</p>

<p><img src="https://i.imgur.com/hGryjww.png" alt="" /></p>

<p>So lets approve this pull request as well.</p>

<p><img src="https://i.imgur.com/LV8eQXY.png" alt="" /></p>

<p>Notice now only policy is failing is the build. Our build is failing.
<img src="https://i.imgur.com/kvyZQ7j.png" alt="" /></p>

<p>Lets go to the source code and fix the code and check-in to the feature branch.
<img src="https://i.imgur.com/j5J1EjA.png" alt="" /></p>

<p>Notice Automatically, our build will be triggered on the same pull request.
<img src="https://i.imgur.com/AxAjZNe.png" alt="" /></p>

<p>Notice build succeed this time. <img src="https://i.imgur.com/t7RFNPz.png" alt="" /></p>

<p>Complete the pull request I will select <code class="language-plaintext highlighter-rouge">Squash commit</code></p>

<p><img src="https://i.imgur.com/p63SNYp.png" alt="" /></p>

<p>Once you complete merge then again it will trigger a build which will run in
master branch.</p>

<p><img src="https://i.imgur.com/fbyAstv.png" alt="" /></p>

<p>Finally code will be submitted to master branch.</p>

<p><img src="https://i.imgur.com/SvykIPT.png" alt="" /></p>

<h2 id="can-i-push-changes-directly-to-a-branch-after-a-branch-policy-is-configured">Can I push changes directly to a branch after a branch policy is configured?</h2>

<p>No, If you try to directly change the master branch it will show error saying u
must create pull request. Which is good protection.</p>

<p><img src="https://i.imgur.com/LnCenbi.png" alt="" /></p>

<h2 id="git-repo-tags">Git Repo Tags</h2>

<p>Notice for each successful merge to master we see tags are created.
<img src="https://i.imgur.com/n0iwkpd.png" alt="" /></p>

<h2 id="why-do-we-see-2-build-for-one-pull-request">Why do we see 2 build for one Pull Request</h2>

<p>If we create/update a PR, it will create a Pull request build, this build will
only trigger the release stage which enable the Pull request trigger. If we
complete a PR, it will create a CI build, and this build will trigger the
release stage which enable CD. That‚Äôs how it is designed, because if</p>

<p>your PR is not finished, every time you update the code (assuming the code is
incorrect), your deployment will be triggered by this PR build, then this
deployment must be meaningless(because your code has not been modified to
complete), it will bring extra trouble to your deployment. The logic we designed
is that only when you complete this PR (all error codes are modified) will a CI
build be generated in the merge phase, which will trigger the CD.</p>

<h2 id="reference">Reference</h2>

<p><a href="https://docs.microsoft.com/en-us/azure/devops/repos/git/branch-policies?view=azure-devops">Improve code quality with branch policies</a></p>

<p><a href="https://developercommunity.visualstudio.com/content/problem/569286/pull-request-trigger-runs-stage-deployment-for-pr.html">Why 2 Builds while protecting master branch</a></p>

<h2 id="conclusion">Conclusion</h2>

<p>We successfully protected our master branch in the repo. However, the
dis-advantage is now our builds are running 2 times for each pull request and
merge to master. This is the sacrifice that you have to do in order to protect
your branch.</p>

<h2 id="become-full-stack-developer-">Become full stack developer üíª</h2>

<p>If you want to become full stack developer and grow your carrier as new software
developer or Lead Developer/Architect. Consider subscribing to our full stack
development training programs. We have All-Access Monthly membership plans and
you will get unlimited access to all of our video courses, slides, source code &amp;
Monthly video calls.</p>

<ul>
  <li>Please subscribe to
<a href="https://www.fullstackmaster.net/pro">All-Access Membership PRO plan</a> to
access current and future angular, node.js and related courses.</li>
  <li>Please subscribe to
<a href="https://www.fullstackmaster.net/elite">All-Access Membership ELITE plan</a> to
get everything from PRO plan. Additionally, you will get access to monthly
live Q&amp;A video call with Rupesh and you can ask doubts/questions and get more
help, tips and tricks.</li>
</ul>

<blockquote>
  <p>Your bright future is awaiting for you so visit today
<a href="www.fullstackmaster.net">FullstackMaster</a> and allow me to help you to board
on your dream software company as a Developer,Architect or Lead Engineer role.</p>
</blockquote>

<p><strong>üíñ Say üëã to me!</strong></p>

<div> 
Rupesh Tiwari </div>
<div>
<a href="https://www.rupeshtiwari.com"> www.rupeshtiwari.com</a> </div>
<div>
‚úâÔ∏è <a href="mailto:rupesh.tiwari.info@gmail.com?subject=Hi"> Email Rupesh</a> </div>
<div>
Founder of <a href="https://www.fullstackmaster.net"> Fullstack Master</a></div>
<div>
</div>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#azure" class="page__taxonomy-item" rel="tag">azure</a><span class="sep">, </span>
    
      <a href="/tags/#beginners" class="page__taxonomy-item" rel="tag">beginners</a><span class="sep">, </span>
    
      <a href="/tags/#devops" class="page__taxonomy-item" rel="tag">devops</a><span class="sep">, </span>
    
      <a href="/tags/#tutorial" class="page__taxonomy-item" rel="tag">tutorial</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-01-19T19:00:00-05:00">January 19, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rupeshtiwari_co&text=Branch+protection+in+Azure+DevOps%20https%3A%2F%2Fwww.rupeshtiwari.com%2Fbranch-protection-in-azure-devops%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.rupeshtiwari.com%2Fbranch-protection-in-azure-devops%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.rupeshtiwari.com%2Fbranch-protection-in-azure-devops%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/2021-01-17-creating-subscription-in-azure-ci-cd-pipeline/" class="pagination--pager" title="Creating Subscription in Azure CI Pipeline
">Previous</a>
    
    
      <a href="/sharing-variables-within-tasks-in-azure-ci-pipeline/" class="pagination--pager" title="Sharing Variables within Tasks in Azure CI Pipeline
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/zZYQYQA.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/server-deployment-strategies-and-storage-spaces-direct-fault-tolerence-in-azure/" rel="permalink">Server Deployment Strategies and Storage Spaces Direct Fault Tolerance in Azure
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Learn how Storage Spaces Direct provides you a Data fault tolerance at verity of levels. You don‚Äôt loose data at any stage. You get Data resiliency out of...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/zZYQYQA.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/introduction-to-azure-infrastructure-architecture/" rel="permalink">Introduction to Azure Infrastructure Architecture
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          5 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Understanding Azure architecture gives you power to learn lots of higher level concepts on Azure like Virtual Machine scale sets etc. Therefore, in this a...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/zZYQYQA.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/what-is-azure-virtual-machine-scale-sets/" rel="permalink">What is Azure Virtual Machine Scale Sets
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Now a days distributed architecture is common. We deploy our services into many different servers to scale them up and meet our demand. However, managing ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/zZYQYQA.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/create-update-and-delete-tags-on-azure-resource/" rel="permalink">Create Update and Delete Tags on Azure Resource
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          3 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Learn more about how to use tags to organize your Azure resources and management hierarchy. Also learn the cmdlet used to fetch tags from Azure resources.


</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script data-ad-client="ca-pub-1700383344966810" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Disable Inspection Function -->
<script type="text/javascript">
  
</script>
<script>
    document.onkeydown = function (e) {
        if (event.keyCode == 123) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
            return false;
        }
    }
</script>
<div id='tawk_5eff6dee223d045fcb7b449a'></div>
<!--Start of Tawk.to Script-->
<script type="text/javascript">
    var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
    (function () {
        var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src = 'https://embed.tawk.to/5eff6dee223d045fcb7b449a/default';
        s1.charset = 'UTF-8';
        s1.setAttribute('crossorigin', '*');
        s0.parentNode.insertBefore(s1, s0);
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.9.2/mermaid.min.js"></script>
<script>
    mermaid.initialize({ startOnLoad: true });
</script>
<link rel="stylesheet" href="/assets/css/blog.css">
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.rupeshtiwari.com/posts" rel="nofollow noopener noreferrer"><i class="fas fa-registered" aria-hidden="true"></i> Blogs for Developers</a></li>
        
      
        
          <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://fullstackmaster.net/course/3/mastering-meanjs" rel="nofollow noopener noreferrer"><i class="fab fa-angular" aria-hidden="true"></i> Learn Angular</a></li>
        
      
        
          <li><a href="https://github.com/rupeshtiwari#javascript-for-beginners-client-side" rel="nofollow noopener noreferrer"><i class="fas fa-crown" aria-hidden="true"></i> Become Software Developer Free</a></li>
        
      
        
          <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i> Medium</a></li>
        
      
        
          <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i> Dev.to</a></li>
        
      
        
          <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i> Fullstack Master</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rupesh Tiwari - Founder of Fullstack Master. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://www.rupeshtiwari.com/branch-protection-in-azure-devops/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/branch-protection-in-azure-devops"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-rupeshtiwari-github-io-1.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
