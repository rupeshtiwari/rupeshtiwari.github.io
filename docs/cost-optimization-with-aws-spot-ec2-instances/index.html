<!doctype html>
<!--
  Minimal Mistakes Jekyll Theme 4.22.0 by Michael Rose
  Copyright 2013-2020 Michael Rose - mademistakes.com | @mmistakes
  Free for personal and commercial use under the MIT license
  https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE
-->
<html lang="en" class="no-js">
  <head>
    <meta charset="utf-8">

<!-- begin _includes/seo.html --><title>Cost Optimization with Amazon EC2 Spot Instances - Rupesh Tiwari - Founder of Fullstack Master</title>
<meta name="description" content="Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instances you can save up to 90% of on-demand pricing. In this article you will learn what spot instances and what should be your strategy to use spot instances. Additionally, I will give you scenarios where most of the customers are using spot instances.">


  <meta name="author" content="Rupesh Tiwari">
  
  <meta property="article:author" content="Rupesh Tiwari">
  


<meta property="og:type" content="article">
<meta property="og:locale" content="en_US">
<meta property="og:site_name" content="Rupesh Tiwari - Founder of Fullstack Master">
<meta property="og:title" content="Cost Optimization with Amazon EC2 Spot Instances">
<meta property="og:url" content="https://www.rupeshtiwari.com/cost-optimization-with-aws-spot-ec2-instances/">


  <meta property="og:description" content="Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instances you can save up to 90% of on-demand pricing. In this article you will learn what spot instances and what should be your strategy to use spot instances. Additionally, I will give you scenarios where most of the customers are using spot instances.">



  <meta property="og:image" content="https://i.imgur.com/7tGRoEv.png">



  <meta name="twitter:site" content="@rupeshtiwari_co">
  <meta name="twitter:title" content="Cost Optimization with Amazon EC2 Spot Instances">
  <meta name="twitter:description" content="Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instances you can save up to 90% of on-demand pricing. In this article you will learn what spot instances and what should be your strategy to use spot instances. Additionally, I will give you scenarios where most of the customers are using spot instances.">
  <meta name="twitter:url" content="https://www.rupeshtiwari.com/cost-optimization-with-aws-spot-ec2-instances/">

  
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://i.imgur.com/7tGRoEv.png">
  

  



  <meta property="article:published_time" content="2021-12-11T00:00:00+00:00">





  
    <meta property="article:publisher" content="https://www.facebook.com/fullstackmaster1">
  

  
    <meta property="fb:app_id" content="421181512329379">
  


<link rel="canonical" href="https://www.rupeshtiwari.com/cost-optimization-with-aws-spot-ec2-instances/">




<script type="application/ld+json">
  {
    "@context": "https://schema.org",
    
      "@type": "Person",
      "name": null,
      "url": "https://www.rupeshtiwari.com/"
    
  }
</script>



  <meta name="msvalidate.01" content="8BC08291167B3E15CC4FCC21C5895052">




<!-- end _includes/seo.html -->



  <link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Rupesh Tiwari - Founder of Fullstack Master Feed">


<!-- https://t.co/dKP3o1e -->
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
  document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js ';
</script>

<!-- For all browsers -->
<link rel="stylesheet" href="/assets/css/main.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5/css/all.min.css">

<!--[if IE]>
  <style>
    /* old IE unsupported flexbox fixes */
    .greedy-nav .site-title {
      padding-right: 3em;
    }
    .greedy-nav button {
      position: absolute;
      top: 0;
      right: 0;
      height: 100%;
    }
  </style>
<![endif]-->


    <!-- start custom head snippets -->

<!-- insert favicons. use https://realfavicongenerator.net/ -->

<!-- end custom head snippets -->

  </head>

  <body class="layout--single">
    <nav class="skip-links">
  <h2 class="screen-reader-text">Skip links</h2>
  <ul>
    <li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li>
    <li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li>
    <li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li>
  </ul>
</nav>

    <!--[if lt IE 9]>
<div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div>
<![endif]-->

    

<div class="masthead">
  <div class="masthead__inner-wrap">
    <div class="masthead__menu">
      <nav id="site-nav" class="greedy-nav">
        
        <a class="site-title" href="/">
          Rupesh Tiwari
          <span class="site-subtitle">Sr. Software Architect, Author & Trainer</span>
        </a>
        <ul class="visible-links"><li class="masthead__menu-item">
              <a href="/posts/">blog</a>
            </li><li class="masthead__menu-item">
              <a href="/about/">about</a>
            </li><li class="masthead__menu-item">
              <a href="https://youtube.com/fullstackmaster">youtube</a>
            </li><li class="masthead__menu-item">
              <a href="/tags/">tags</a>
            </li><li class="masthead__menu-item">
              <a href="/consulting/">consulting</a>
            </li><li class="masthead__menu-item">
              <a href="https://www.fullstackmaster.net/pro">angular training</a>
            </li><li class="masthead__menu-item">
              <a href="https://fullstackmaster.net/login">sign in</a>
            </li></ul>
        
        <button class="search__toggle" type="button">
          <span class="visually-hidden">Toggle search</span>
          <svg class="icon" width="16" height="16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.99 16">
            <path d="M15.5,13.12L13.19,10.8a1.69,1.69,0,0,0-1.28-.55l-0.06-.06A6.5,6.5,0,0,0,5.77,0,6.5,6.5,0,0,0,2.46,11.59a6.47,6.47,0,0,0,7.74.26l0.05,0.05a1.65,1.65,0,0,0,.5,1.24l2.38,2.38A1.68,1.68,0,0,0,15.5,13.12ZM6.4,2A4.41,4.41,0,1,1,2,6.4,4.43,4.43,0,0,1,6.4,2Z" transform="translate(-.01)"></path>
          </svg>
        </button>
        
        <button class="greedy-nav__toggle hidden" type="button">
          <span class="visually-hidden">Toggle menu</span>
          <div class="navicon"></div>
        </button>
        <ul class="hidden-links hidden"></ul>
      </nav>
    </div>
  </div>
</div>


    <div class="initial-content">
      
  







<div class="page__hero"
  style=" background-image: url('');"
>
  
    <img src="https://i.imgur.com/7tGRoEv.png" alt="Cost Optimization with Amazon EC2 Spot Instances" class="page__hero-image">
  
  
</div>




  
    



<nav class="breadcrumbs">
  <ol itemscope itemtype="https://schema.org/BreadcrumbList">
    
    
    
      
        <li itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem">
          <a href="https://www.rupeshtiwari.com/" itemprop="item"><span itemprop="name">Home</span></a>
          <meta itemprop="position" content="1" />
        </li>
        <span class="sep">/</span>
      
      
        <li class="current">Cost Optimization with Amazon EC2 Spot Instances</li>
      
    
  </ol>
</nav>

  


<div id="main" role="main">
  
  <div class="sidebar sticky">
  


<div itemscope itemtype="https://schema.org/Person">

  
    <div class="author__avatar">
      
        <img src="/assets/images/bio-photo.jpg" alt="Rupesh Tiwari" itemprop="image">
      
    </div>
  

  <div class="author__content">
    
      <h3 class="author__name" itemprop="name">Rupesh Tiwari</h3>
    
    
      <div class="author__bio" itemprop="description">
        <p>I help students and professionals to become Full Stack Software Developer in less than a year!</p>

      </div>
    
  </div>

  <div class="author__urls-wrapper">
    <button class="btn btn--inverse">Follow</button>
    <ul class="author__urls social-icons">
      

      
        
          
            <li><a href="rupesh.tiwari.info@gmail.com" rel="nofollow noopener noreferrer"><i class="fas fa-fw fa-envelope-square" aria-hidden="true"></i><span class="label">Email</span></a></li>
          
        
          
            <li><a href="/posts/" rel="nofollow noopener noreferrer"><i class="fa fa-th-large" aria-hidden="true"></i><span class="label">Blogs</span></a></li>
          
        
          
            <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i><span class="label">Medium</span></a></li>
          
        
          
            <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i><span class="label">Dev.to</span></a></li>
          
        
          
            <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i><span class="label">GitHub</span></a></li>
          
        
          
            <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span class="label">LinkedIn</span></a></li>
          
        
          
            <li><a href="http://twitter.com/rupeshtiwari_co" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-twitter-square" aria-hidden="true"></i><span class="label">Twitter</span></a></li>
          
        
          
            <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i><span class="label">Facebook</span></a></li>
          
        
          
            <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i><span class="label">Angular Training</span></a></li>
          
        
      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      

      <!--
  <li>
    <a href="http://link-to-whatever-social-network.com/user/" itemprop="sameAs" rel="nofollow noopener noreferrer">
      <i class="fas fa-fw" aria-hidden="true"></i> Custom Social Profile Link
    </a>
  </li>
-->
    </ul>
  </div>
</div>

  
  </div>



  <article class="page" itemscope itemtype="https://schema.org/CreativeWork">
    <meta itemprop="headline" content="Cost Optimization with Amazon EC2 Spot Instances">
    <meta itemprop="description" content="  Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instances you can save up to 90% of on-demand pricing. In this article you will learn what spot instances and what should be your strategy to use spot instances. Additionally, I will give you scenarios where most of the customers are using spot instances.">
    <meta itemprop="datePublished" content="2021-12-11T00:00:00+00:00">
    

    <div class="page__inner-wrap">
      
        <header>
          <h1 id="page-title" class="page__title" itemprop="headline">Cost Optimization with Amazon EC2 Spot Instances
</h1>
          

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          11 minute read
        
      </span>
    
  </p>


        </header>
      

      <section class="page__content" itemprop="text">
        
          <aside class="sidebar__right sticky">
            <nav class="toc">
              <header><h4 class="nav__title"><i class="fas fa-file-alt"></i> On this page</h4></header>
              <ul class="toc__menu"><li><a href="#amazon-ec2-purchasing-options">Amazon EC2 Purchasing Options</a><ul><li><a href="#on-demand-instances">On-Demand Instances</a></li><li><a href="#reserved-instances">Reserved Instances</a></li><li><a href="#saving-plans">Saving Plans</a></li></ul></li><li><a href="#spot-instances">Spot InstancesÂ </a></li><li><a href="#aws-spare-capacity">AWS Spare Capacity</a></li><li><a href="#spot-instance-use-cases">Spot Instance Use Cases</a></li><li><a href="#spot-market">Spot Market</a></li><li><a href="#spot-instance-best-practices">Spot Instance Best Practices</a></li><li><a href="#bursty-workload-optimization-strategy-with-spot-instances">Bursty Workload Optimization strategy with Spot InstancesÂ </a><ul><li><a href="#bursty-workload-example">Bursty Workload example</a></li><li><a href="#spot-instances-strategy-for-bursty-workloads">Spot Instances Strategy for Bursty Workloads</a></li></ul></li><li><a href="#summary">Summary</a></li></ul>

            </nav>
          </aside>
        
        <blockquote>
  <p>Creating cost optimized highly scalable cloud architecture is challenging but it is possible! Using Spot Amazon Elastic Compute Cloud (Amazon EC2) instances you can save up to 90% of on-demand pricing. In this article you will learn what spot instances and what should be your strategy to use spot instances. Additionally, I will give you scenarios where most of the customers are using spot instances.</p>
</blockquote>

<h2 id="amazon-ec2-purchasing-options">Amazon EC2 Purchasing Options</h2>

<p>Amazon Elastic Compute Cloud (Amazon EC2) offers 3 purchasing options:</p>

<ol>
  <li>On-Demand</li>
  <li>Reserved Instances</li>
  <li>Saving Plans</li>
  <li>Spot Instances</li>
</ol>

<p>All of the above Amazon EC2 purchase options are also available in Microsoft Azure and Google Cloud Platform (GCP). So if you are still in a Multi-Cloud environment still you must continue reading this article.</p>

<p>Normally, when you are designing your workload in the cloud. Make sure you combine all three of them to get better performance and huge cost savings. Amazon Auto Scaling Group (ASG) can help you to set up rules and conditions to add the desired type of the instances when set up correctly. You can combine on-demand, reserved and spot instances in a single ASG.</p>

<h3 id="on-demand-instances">On-Demand Instances</h3>

<p>Pay for compute capacity by the second or hour with no long-term commitments. Mostly you will use these instances for the spiky workloads or to define needs of your workload. Example: Netflix uses on-demand EC2 instances at off hours to split, encode the video files.</p>

<p><img src="https://i.imgur.com/BAd22sC.png" alt="" class="full" /></p>

<h3 id="reserved-instances">Reserved Instances</h3>

<p>Significant discount (up to 70%) compared to on-demand instance pricing. You should use these types of instances for steady state applications or predictable usages, databases. <img src="https://lh6.googleusercontent.com/IYJsC3v5updKOqxDw2n2EdrOW6aG6tAU_D4iS0E-WgwCe0zsOK98aar8fYibwrKCu4CYfszSTxQyhqdjksyYIr14hq4Xgb1fJhXTpVk8IzHRu69ok4uJ19xNh86dWPZ1oAOegL9V" alt="" /></p>

<p>Example: your production servers or database servers or domain controllers that work regularly every year. You donâ€™t want to turn them off for several years and keep these instances for the next 3-4 years or more. Then you can purchase reserved instances, with discounted prices and save huge costs.</p>

<h3 id="saving-plans">Saving Plans</h3>

<p>Same level of discount as you get from Reserved Instances however, you get more flexibility.</p>

<p>The flexibility to access computers across EC2 and AWS Fargate.</p>

<p><img src="https://lh6.googleusercontent.com/e-U_KjFJXnLZkbMpwMNWAd-v4rOxSAdTDg8fDOMxSTGgHfM86RMQoJ7_jjATpQ8BhfhtsK5A1Axx-6VUH56CAyRDJj6o0QTE_IwMUoikFg8bezlCc-fAzZ2f_8nx2cj0vGQ4JMtA" alt="" /></p>

<h2 id="spot-instances">Spot InstancesÂ </h2>

<p>Spare Amazon EC2 capacity for up to 90% discount compared to on-demand instance pricing. You can use these instances for fault tolerant stateless applications, instance flexible or time-sensitive workloads. Spot instances are identical to on-demand instances in terms of performance, infrastructure platform.</p>

<p><img src="https://lh3.googleusercontent.com/61yRh1SvEhkZ2ZMwHTWxlMFWE2T-JOxMax217ZHg6uaUgIRF8FKkpDVtV0SJ1bbPXE2kTAJlwOfwDSzqIQOzOrcnrfwZhK_tfdeoB6dprd1v7d-wDJ4nzs8YenGlPAYk8v8TQUvG" alt="" /></p>

<p>One thing to note is that AWS can reclaim these instances with just a 2 minute notice. Therefore, you must plan for a backup strategy while you are using spot instances. Or try to use the spot instances for the use case where you do not want to store the files, data, state or session. You should do stateless activities on spot instances to be on safer side. Amazon EC2 Spot instances are low cost, easy to use and flexible. In Big Data and Analysis use cases lots of customers are using spot instances.</p>

<h2 id="aws-spare-capacity">AWS Spare Capacity</h2>

<p>Amazon AWS does not reserve a minimum or maximum amount of capacity in spare. However, for the on-demand instances in order to give elasticity AWS has to keep spare capacity. Additionally, when a customer is not using on-demand instances then those capacity AWS keep it for spot customers to leverage the available capacity. AWS offers a huge up to 90% discount to spot customers with the caveat that whenever AWS needs the capacity back from you for on-demand customers, AWS will give you a 2-minute warning and take the server back off from you.</p>

<p>On average, every week, AWS customers are using more compute capacity on Amazon EC2 Spot Instances than customers in 2013 were running across all of Amazon EC2.</p>

<h2 id="spot-instance-use-cases">Spot Instance Use Cases</h2>

<p>Spot instances are perfectly good for below scenarios:</p>

<ul>
  <li>Fault-tolerant</li>
  <li>Flexible workloads</li>
  <li>Loosely coupled systems</li>
  <li>Stateless workloads</li>
</ul>

<p>In all of these above scenarios, you can trade off spot instance interruption with the huge money saving. Many customers are using spot instances for below use cases:</p>

<ul>
  <li>Big Data</li>
  <li>CI/CD</li>
  <li>Web Services</li>
  <li>HPC (High Performance Compute)</li>
</ul>

<p>Big Data use cases you might have some state while computing and when you lose the computer with 2-minute notice then your work is interrupted. However, in order to not lose state make sure you are using non-instance state like s3, HDFS, etc.</p>

<p>CI/CD use cases you can use spot instances. In CI/CD server you run build, test etc. Maximum time CI/CD tasks, workflows and pipelines are well capable to handle any kind of server failure. Therefore, a good use case for spot instances.</p>

<p>WebServices can use spot instances. If you are designing stateless and scalable web services by creating multiple spot instances putting them behind the load balancer then in-case one machine is taken away by AWS, you have other capacity to server for future requests. Only 5% of the time your one instance will be interrupted by AWS so existing running work interruption chances are there but very less. Since most of the time your work will be finished.</p>

<p>High Performance Computers (HPC) can use spot instances. In the Finance domain most of the Grid that uses HPC with high throughput computing workloads which is loosely coupled can be done using spot instances. In Grid single node failing does not destroy the entire cluster. Similarly for big data we can use spot instances where anytime interruption occurs itâ€™s just a matter of quickly reprocessing.</p>

<h2 id="spot-market">Spot Market</h2>

<p>The Spot Market is the unique combination of instance type and availability zone. The supply and demand ofÂ  the instance type in that availability zone is what drives the price.</p>

<p>The following screenshot shows a price comparison for different instance types. If you see the price history of c5 large instance types over the past 3 months it is pretty stable. In this graph below we are looking at the spot market for 4 different type of instances.</p>

<p><img src="https://lh5.googleusercontent.com/q_tMVbNI0yZn2rtOPE10dc1DmzStsmm_TrGO-wknKHSyj6R_4WVaRyTq8GVhf3m74_Dpl_hH5Cz9CBKB_D3WnE40z3KL0fXf-P_fLvd7ar6BO7xIMnuqSzQJGNAYkPXfnk5Xs2QD" alt="" /></p>

<h2 id="spot-instance-best-practices">Spot Instance Best Practices</h2>

<p>While AWS never runs out of spot capacity it is possible for a specific instance, for a specific zone might not be enough spot instances available for you. Therefore, if you ask for 100 spots you may get only 50 of them. So in order to solve this problem you should not be tied with one type of spot instance rather you should use the spot capacity pool given by AWS.</p>

<p>Additionally you must plan for interruptions since at 2 minute notice AWS can take back the spot instance from you. Over the last 3 months, 95% of spot instance interruptions were from a customer manually terminating the instance because the application had completed its work. So basically 5% of the time Amazon actually interrupts customers so 95% of time you should be able to work with spot instances without interruption.</p>

<p>If you are architecting a highly scalable workload then Amazon auto scaling group (ASG) can help you to select the instance type, spot allocation strategy like cheapest instance, also define the split percentage between spot and on-demand instances and let ASG handle this AWS spot instance take back interruption. AWS will automatically spin up new spot instances. I have seen customers define base on-demand instances and in order to boost their application they utilize spot instances and save on 90% cost.</p>

<p>Either you can set up ASG to spin 100% spot instances on top of the on-demand instances as your base capacity.</p>

<p><img src="https://lh6.googleusercontent.com/vLP5Kp8O44m7WC6gyh3R4LYLsY__8aKucZS0Gdmjmu2q6zhh3wf0s5Qi7U7QNfFUq4SOL_R12267Z4iZsFZHd1HJVGlLx0cVGMNi0A3GLk_j5c8dl7g9iCUePhW5_ME44JnP75CQ" alt="" /></p>

<p>Many customers also set up ASG to spin 50% spot instances and 50% on-demand instances on top of spot instances. Still keep their base capacity as on-demand instances.</p>

<p><img src="https://lh5.googleusercontent.com/GVQA8D6imd0PjyIGv3VVKM6NwH-G79FWS5q-6M7JervqfwXT2R_I5twCH-qs2HsGMvZtswLABXnM-IYObSuW40FrAYpldcRXZLCRTAm1jXskooOg8A9Lhkx6lCxUFrqkHAes6cS6" alt="" /></p>

<p>Amazon EC2 Auto Scaling dynamically reacts to the changing demand and optimizes cost as well. ASG has Fleet management where it replaces unhealthy instances. ASG also has Dynamic scaling to scale on demand.</p>

<p>In order to optimize your Amazon EC2 workload combine the purchase options.</p>

<ul>
  <li>In order to run steady-state workloads use reserved instances or saving plans,</li>
  <li>For bursty, new or stateful spiky workloads use on-demand instances and</li>
  <li>For fault tolerant applications, flexible and stateless workloads use spot instances.</li>
</ul>

<p><img src="https://lh6.googleusercontent.com/PYRzFV0AubudQEFWGltkzw2F8ty_VISvhdUa_ast4DyjOHCssfKzgw1f2PmM6SBm3L04K2bOxAHGYiTk59wd0xgpi4eTgWELvy3tyfD9itGrpXVduqvvpmraspMkyBD8D8k8QZ5i" alt="" /></p>

<h2 id="bursty-workload-optimization-strategy-with-spot-instances">Bursty Workload Optimization strategy with Spot InstancesÂ </h2>

<h3 id="bursty-workload-example">Bursty Workload example</h3>

<p>In typical capital market domain different types of analytical workloads are there such as below:</p>

<ol>
  <li>Research
    <ul>
      <li>How to increase profit or reduce risk of a portfolio</li>
    </ul>
  </li>
  <li>Reactionary
    <ul>
      <li>Human or an automatic system determine significant market volatility in the middle of trading day</li>
    </ul>
  </li>
  <li>Overnight Jobs
    <ul>
      <li>At the end of the trading day, you collect most recent input for your models andÂ  you run them at large scale</li>
    </ul>
  </li>
  <li>Model backtesting
    <ul>
      <li>When you make code changes to the model you need to test the changes with 10-20 years of historical data. High resource intensive workload and you need performance since you want to deploy the model in production as well.</li>
    </ul>
  </li>
</ol>

<p>In order to support such a high bursty workload you need infrastructure to auto spinning spot instances and shut them down once a task is done. You can use your own job scheduler or open source from HashiCorp as below.</p>

<ul>
  <li><a href="https://www.nomadproject.io/docs/internals/scheduling/scheduling">Nomad</a> : Job Scheduling</li>
  <li><a href="https://www.consul.io/">Consul</a> : Health Check, Load Balancing and Service Discovery</li>
</ul>

<p>Letâ€™s take one high bursty workload example:</p>

<p>Trading desk running on 2000 core scale to 15,000 core scale during trading hours and overnight it runs about 30,000 core scale. This is the bursty nature of the system in action.</p>

<p>User sends the work job to Queue, the auto scaler docker container checks the state of capacity and talks to the provisioning system and spins up a couple of new capacities. Once the queue is drained it submits the request to shut down the extra capacity to the provisioning system.</p>

<p>2000 jobs are put on the queue at the beginning of trading day they drain quickly. Then 8000, 15000 jobs are put on the queue they drain quickly.</p>

<p>Similarly at the beginning in order to handle 2000 jobs you need 1000 workers then they all shut down again this is very bursty nature. Similarly at different time spans of the day different sets of workers will spin up like 3000 workers for 2 hours, next 4000-7000 workers for next 2 hours and so on. These are all bursty behaviour of your system.</p>

<h3 id="spot-instances-strategy-for-bursty-workloads">Spot Instances Strategy for Bursty Workloads</h3>

<p>How would you strategize your spot market such that you create a healthy and performant workload in this situation?</p>

<p><strong>Diversified allocation strategy</strong> across as many instance pools as possible is the key to quickly achieving scale and minimizing the size of termination events.</p>

<ul>
  <li>Configure your fleet to start up in multiple spot markets in parallel</li>
  <li>Build your Launch spec a large number of spotÂ  markets that you need to accept resources</li>
  <li>It will give you quick fleet whenever you need to compute in high volume</li>
  <li>Your instances are spread out across a large number of spot markets with few instances belonging to a single spot market.</li>
  <li>So if you get termination notification from AWS in one spot market it wont impact much in your over workload.</li>
</ul>

<p>In order to spin up 32 instances each of 30,000 core clusters of spot instances may take an hour or so. Therefore, if you use multiple spot market pools in your launch specification that can reduce your fleet startup timeÂ  to around 15 minutes. Your startup time can be sped up 70-80% with this diversified allocation strategy. So create a pool of instances and diversify them.</p>

<p><strong>Make it as simple</strong> as possible. AWS gives variety of EC2 instances you can group machines by their features such as</p>

<ul>
  <li><strong>Compute intensive</strong>: high compute capacity category</li>
  <li><strong>Memory intensive</strong>: memory optimized capacity category</li>
  <li><strong>Standard</strong>: rest machines can be categorized as standard</li>
</ul>

<p>This way you can abstract out the AWS terminologies, instance types, number of cores etc. Rather you define workload memory intensive if they require more memory during work.</p>

<p><strong>Build in safeties governors</strong> everywhere. Tag your resources such that you know which team stakeholders are responsible for the payment. Put a threshold on capacity by applying some policy and governance to not spin 3000 vCore machines if you need only 1000 vCore. If you made a mistake and scale up unnecessary then you will end up paying a couple of thousands extra. Therefore, you have to apply strong governance and safety.</p>

<p><strong>Monitor &amp; Alert</strong>: If you have bursty large-scale systems where 30,000 vcore spot fleets and 3 or 4 of them running. However, ifÂ  your system is not working then you are wasting your huge amount of money. Therefore, you must set up monitoring and alerts to send sms to the core team to get human involvement to tackle the next set of actions for a critical incident.</p>

<h2 id="summary">Summary</h2>

<p>The Amazon bill is pretty complex. I am pretty sure every cloud provider bills must be the same structure. You have a lot of things and various associated costs with your virtual machines / EC2 instances. Therefore you must do your own maths and explore your cost in depth. There are many other costs you have to consider, not just the machines. Cost management is not a one day job. You must monitor them very frequently. You can check quarterly and also check future expected bills etc to learn more and tune them. Spot instances are great but power comes with responsibility. So make sure the applications that you are designing to run on spot are fault tolerant, stateless and scalable.</p>

<hr />

<p><em>Thanks for reading my article till end. I hope you learned something special today. If you enjoyed this article then please share to your friends and if you have suggestions or thoughts to share with me then please write in the comment box.</em></p>

<div class="notice--success">
<strong>ðŸ’– Say ðŸ‘‹ to me!</strong>
<br />Rupesh Tiwari
<br />Founder of <a href="https://www.fullstackmaster.net">Fullstack Master </a>
<br />Email: <a href="mailto:rupesh.tiwari.info@gmail.com?subject=Hi">rupesh.tiwari.info@gmail.com</a>
<br />Website: <a href="https://www.rupeshtiwari.com">RupeshTiwari.com </a>
</div>
<p><img src="https://imgur.com/5fBatz9.png" alt="" class="full" /></p>

        
      </section>

      <footer class="page__meta">
        
        
  


  

  <p class="page__taxonomy">
    <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong>
    <span itemprop="keywords">
    
      <a href="/tags/#aws" class="page__taxonomy-item" rel="tag">aws</a><span class="sep">, </span>
    
      <a href="/tags/#beginners" class="page__taxonomy-item" rel="tag">beginners</a><span class="sep">, </span>
    
      <a href="/tags/#cloud" class="page__taxonomy-item" rel="tag">cloud</a><span class="sep">, </span>
    
      <a href="/tags/#tutorial" class="page__taxonomy-item" rel="tag">tutorial</a>
    
    </span>
  </p>




        
  <p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2021-12-11T00:00:00+00:00">December 11, 2021</time></p>


      </footer>

      <section class="page__share">
  

  <a href="https://twitter.com/intent/tweet?via=rupeshtiwari_co&text=Cost+Optimization+with+Amazon+EC2+Spot+Instances%20https%3A%2F%2Fwww.rupeshtiwari.com%2Fcost-optimization-with-aws-spot-ec2-instances%2F" class="btn btn--twitter" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Twitter"><i class="fab fa-fw fa-twitter" aria-hidden="true"></i><span> Twitter</span></a>

  <a href="https://www.facebook.com/sharer/sharer.php?u=https%3A%2F%2Fwww.rupeshtiwari.com%2Fcost-optimization-with-aws-spot-ec2-instances%2F" class="btn btn--facebook" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on Facebook"><i class="fab fa-fw fa-facebook" aria-hidden="true"></i><span> Facebook</span></a>

  <a href="https://www.linkedin.com/shareArticle?mini=true&url=https%3A%2F%2Fwww.rupeshtiwari.com%2Fcost-optimization-with-aws-spot-ec2-instances%2F" class="btn btn--linkedin" onclick="window.open(this.href, 'window', 'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;" title="Share on LinkedIn"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i><span> LinkedIn</span></a>
</section>


      
  <nav class="pagination">
    
      <a href="/cloud-security-defense-in-depth-azure-approach/" class="pagination--pager" title="Cloud Security Defense In-Depth Azure Approach
">Previous</a>
    
    
      <a href="/how-to-improve-reliability-in-the-cloud/" class="pagination--pager" title="How to improve Reliability in the cloud?
">Next</a>
    
  </nav>

    </div>

    
  </article>

  
  
    <div class="page__related">
      <h4 class="page__related-title">You May Also Enjoy</h4>
      <div class="grid__wrapper">
        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/8axKkdp.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-improve-reliability-in-the-cloud/" rel="permalink">How to improve Reliability in the cloud?
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          9 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  Did you get a phone call from your customer saying they want to improve their application reliability while you move their workload to the cloud? If yes t...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/WQWdzrb.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/cloud-security-defense-in-depth-azure-approach/" rel="permalink">Cloud Security Defense In-Depth Azure Approach
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          10 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  In a traditional data center you create one perimeter, secure them by installing firewall, WAF, SIEMS etc. and have 100% confidence that the data center i...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/aPeeiUM.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/how-to-maintain-well-architected-framework-on-cloud/" rel="permalink">How to Maintain Well-Architected-Framework on Cloud
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">How to make sure our workload in the cloud is secure, reliable. How to monitor the cost of your cloud resources consumption? Is there any automation you can ...</p>
  </article>
</div>

        
          



<div class="grid__item">
  <article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork">
    
      <div class="archive__item-teaser">
        <img src="https://i.imgur.com/fi40PUP.png" alt="">
      </div>
    
    <h2 class="archive__item-title no_toc" itemprop="headline">
      
        <a href="/what-is-ebit-and-ebitda/" rel="permalink">What is EBIT and EBITDA in Finance?
</a>
      
    </h2>
    

  <p class="page__meta">
    

    

    
      
      

      <span class="page__meta-readtime">
        <i class="far fa-clock" aria-hidden="true"></i>
        
          4 minute read
        
      </span>
    
  </p>


    <p class="archive__item-excerpt" itemprop="description">
  EBITDA and EBIT is a very fundamental financial term that is nowadays mostly considered during the cloud adoption phase for IT companies. If your company ...</p>
  </article>
</div>

        
      </div>
    </div>
  
  
</div>

    </div>

    
      <div class="search-content">
        <div class="search-content__inner-wrap"><form class="search-content__form" onkeydown="return event.key != 'Enter';">
    <label class="sr-only" for="search">
      Enter your search term...
    </label>
    <input type="search" id="search" class="search-input" tabindex="-1" placeholder="Enter your search term..." />
  </form>
  <div id="results" class="results"></div></div>

      </div>
    

    <div id="footer" class="page__footer">
      <footer>
        <script data-ad-client="ca-pub-1700383344966810" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>
<!-- Disable Inspection Function -->
<script type="text/javascript">
  
</script>
<script>
    document.onkeydown = function (e) {
        if (event.keyCode == 123) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'I'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.shiftKey && e.keyCode == 'J'.charCodeAt(0)) {
            return false;
        }
        if (e.ctrlKey && e.keyCode == 'U'.charCodeAt(0)) {
            return false;
        }
    }
</script>
<div id='tawk_5eff6dee223d045fcb7b449a'></div>
<!--Start of Tawk.to Script-->
<script type="text/javascript">
    var Tawk_API = Tawk_API || {}, Tawk_LoadStart = new Date();
    (function () {
        var s1 = document.createElement("script"), s0 = document.getElementsByTagName("script")[0];
        s1.async = true;
        s1.src = 'https://embed.tawk.to/5eff6dee223d045fcb7b449a/default';
        s1.charset = 'UTF-8';
        s1.setAttribute('crossorigin', '*');
        s0.parentNode.insertBefore(s1, s0);
    })();
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mermaid/8.9.2/mermaid.min.js"></script>
<script>
    mermaid.initialize({ startOnLoad: true });
</script>
<link rel="stylesheet" href="/assets/css/blog.css">
        <div class="page__footer-follow">
  <ul class="social-icons">
    

    
      
        
          <li><a href="https://www.rupeshtiwari.com/posts" rel="nofollow noopener noreferrer"><i class="fas fa-registered" aria-hidden="true"></i> Blogs for Developers</a></li>
        
      
        
          <li><a href="https://www.facebook.com/fullstackmaster1" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-facebook-square" aria-hidden="true"></i> Facebook</a></li>
        
      
        
          <li><a href="https://www.linkedin.com/in/rupesh-tiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-linkedin" aria-hidden="true"></i> LinkedIn</a></li>
        
      
        
          <li><a href="https://fullstackmaster.net/course/3/mastering-meanjs" rel="nofollow noopener noreferrer"><i class="fab fa-angular" aria-hidden="true"></i> Learn Angular</a></li>
        
      
        
          <li><a href="https://github.com/rupeshtiwari#javascript-for-beginners-client-side" rel="nofollow noopener noreferrer"><i class="fas fa-crown" aria-hidden="true"></i> Become Software Developer Free</a></li>
        
      
        
          <li><a href="http://github.com/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-fw fa-github" aria-hidden="true"></i> GitHub</a></li>
        
      
        
          <li><a href="https://rupesh-tiwari.medium.com/" rel="nofollow noopener noreferrer"><i class="fab fa-medium" aria-hidden="true"></i> Medium</a></li>
        
      
        
          <li><a href="https://dev.to/rupeshtiwari" rel="nofollow noopener noreferrer"><i class="fab fa-dev" aria-hidden="true"></i> Dev.to</a></li>
        
      
        
          <li><a href="https://www.fullstackmaster.net" rel="nofollow noopener noreferrer"><i class="fas fa-graduation-cap" aria-hidden="true"></i> Fullstack Master</a></li>
        
      
    

    
      <li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li>
    
  </ul>
</div>

<div class="page__footer-copyright">&copy; 2022 Rupesh Tiwari - Founder of Fullstack Master. Powered by <a href="https://jekyllrb.com" rel="nofollow">Jekyll</a> &amp; <a href="https://mademistakes.com/work/minimal-mistakes-jekyll-theme/" rel="nofollow">Minimal Mistakes</a>.</div>

      </footer>
    </div>

    
  <script src="/assets/js/main.min.js"></script>




<script src="/assets/js/lunr/lunr.min.js"></script>
<script src="/assets/js/lunr/lunr-store.js"></script>
<script src="/assets/js/lunr/lunr-en.js"></script>




    
  <script>
    var disqus_config = function () {
      this.page.url = "https://www.rupeshtiwari.com/cost-optimization-with-aws-spot-ec2-instances/";  /* Replace PAGE_URL with your page's canonical URL variable */
      this.page.identifier = "/cost-optimization-with-aws-spot-ec2-instances"; /* Replace PAGE_IDENTIFIER with your page's unique identifier variable */
    };
    (function() { /* DON'T EDIT BELOW THIS LINE */
      var d = document, s = d.createElement('script');
      s.src = 'https://https-rupeshtiwari-github-io-1.disqus.com/embed.js';
      s.setAttribute('data-timestamp', +new Date());
      (d.head || d.body).appendChild(s);
    })();
  </script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


  





  </body>
</html>
